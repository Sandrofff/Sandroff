<!DOCTYPE html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head><link rel="stylesheet" type="text/css" href="https://www.pyimagesearch.com/wp-content/cache/minify/25595.css" media="all" />

<meta charset="UTF-8" />

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<!-- <link rel="stylesheet" type="text/css" href="https://www.pyimagesearch.com/static/css/header_fix.css" media="all"/> -->
<link rel="pingback" href="https://www.pyimagesearch.com/xmlrpc.php" />
<link rel="shortcut icon" href="https://www.pyimagesearch.com/wp-content/themes/canvas/favicon.ico" />

<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>

<!-- This site is optimized with the Yoast SEO plugin v7.0.3 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Mask R-CNN with OpenCV - PyImageSearch</title>
<meta name="description" content="In this tutorial you will learn how to use Mask R-CNN with Deep Learning, OpenCV, and Python to predict pixel-wise masks for every object in an image."/>
<link rel="canonical" href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Mask R-CNN with OpenCV - PyImageSearch" />
<meta property="og:description" content="In this tutorial you will learn how to use Mask R-CNN with Deep Learning, OpenCV, and Python to predict pixel-wise masks for every object in an image." />
<meta property="og:url" content="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/" />
<meta property="og:site_name" content="PyImageSearch" />
<meta property="article:tag" content="deep learning" />
<meta property="article:tag" content="instance segmentation" />
<meta property="article:tag" content="mask r-cnn" />
<meta property="article:tag" content="masks" />
<meta property="article:tag" content="object detection" />
<meta property="article:tag" content="segmentation" />
<meta property="article:tag" content="semantic segmentation" />
<meta property="article:section" content="Deep Learning" />
<meta property="article:published_time" content="2018-11-19T10:00:10-05:00" />
<meta property="article:modified_time" content="2018-11-19T09:52:25-05:00" />
<meta property="og:updated_time" content="2018-11-19T09:52:25-05:00" />
<meta property="og:image" content="https://s3-us-west-2.amazonaws.com/static.pyimagesearch.com/opencv-mask-rcnn/mask_rcnn_example03.gif" />
<meta property="og:image:secure_url" content="https://s3-us-west-2.amazonaws.com/static.pyimagesearch.com/opencv-mask-rcnn/mask_rcnn_example03.gif" />
<meta property="og:image" content="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_segmentation_types.jpg" />
<meta property="og:image:secure_url" content="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_segmentation_types.jpg" />
<meta property="og:image" content="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_rcn_orig.jpg" />
<meta property="og:image:secure_url" content="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_rcn_orig.jpg" />
<meta property="og:image" content="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_fast_rcnn.jpg" />
<meta property="og:image:secure_url" content="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_fast_rcnn.jpg" />
<meta property="og:image" content="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnns_faster_rcnn.jpg" />
<meta property="og:image:secure_url" content="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnns_faster_rcnn.jpg" />
<meta property="og:image" content="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_arch.png" />
<meta property="og:image:secure_url" content="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_arch.png" />
<meta property="og:image" content="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_mask_resizing.jpg" />
<meta property="og:image:secure_url" content="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_mask_resizing.jpg" />
<meta property="og:image" content="https://s3-us-west-2.amazonaws.com/static.pyimagesearch.com/opencv-mask-rcnn/mask_rcnn_example01.gif" />
<meta property="og:image:secure_url" content="https://s3-us-west-2.amazonaws.com/static.pyimagesearch.com/opencv-mask-rcnn/mask_rcnn_example01.gif" />
<meta property="og:image" content="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_roi_mask_segmented.jpg" />
<meta property="og:image:secure_url" content="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_roi_mask_segmented.jpg" />
<meta property="og:image" content="https://s3-us-west-2.amazonaws.com/static.pyimagesearch.com/opencv-mask-rcnn/mask_rcnn_example02.gif" />
<meta property="og:image:secure_url" content="https://s3-us-west-2.amazonaws.com/static.pyimagesearch.com/opencv-mask-rcnn/mask_rcnn_example02.gif" />
<meta property="og:image" content="https://s3-us-west-2.amazonaws.com/static.pyimagesearch.com/opencv-mask-rcnn/mask_rcnn_dogs.gif" />
<meta property="og:image:secure_url" content="https://s3-us-west-2.amazonaws.com/static.pyimagesearch.com/opencv-mask-rcnn/mask_rcnn_dogs.gif" />
<meta property="og:image" content="https://s3-us-west-2.amazonaws.com/static.pyimagesearch.com/opencv-mask-rcnn/mask_rcnn_cars.gif" />
<meta property="og:image:secure_url" content="https://s3-us-west-2.amazonaws.com/static.pyimagesearch.com/opencv-mask-rcnn/mask_rcnn_cars.gif" />
<meta property="og:image" content="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_dl4cv.jpg" />
<meta property="og:image:secure_url" content="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_dl4cv.jpg" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//a.optmnstr.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="PyImageSearch &raquo; Feed" href="http://feeds.feedburner.com/Pyimagesearch" />
<link rel="alternate" type="application/rss+xml" title="PyImageSearch &raquo; Comments Feed" href="https://www.pyimagesearch.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="PyImageSearch &raquo; Mask R-CNN with OpenCV Comments Feed" href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.pyimagesearch.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.4"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56692,8205,9792,65039],[55357,56692,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>








<!--[if lt IE 9]>
<link href="https://www.pyimagesearch.com/wp-content/themes/canvas/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script type="text/javascript" src="https://www.pyimagesearch.com/wp-content/cache/minify/df983.js"></script>


<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/www.pyimagesearch.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.pyimagesearch.com/wp-content/cache/minify/49ed6.js"></script>

<script type='text/javascript' data-cfasync="false" id="omapi-script" async="async" src='https://a.optmnstr.com/app/js/api.min.js'></script>
<script type="text/javascript" src="https://www.pyimagesearch.com/wp-content/cache/minify/83e7b.js"></script>



<link rel='https://api.w.org/' href='https://www.pyimagesearch.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.pyimagesearch.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.pyimagesearch.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.9.4" />
<link rel='shortlink' href='https://www.pyimagesearch.com/?p=8999' />
<link rel="alternate" type="application/json+oembed" href="https://www.pyimagesearch.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.pyimagesearch.com%2F2018%2F11%2F19%2Fmask-r-cnn-with-opencv%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://www.pyimagesearch.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.pyimagesearch.com%2F2018%2F11%2F19%2Fmask-r-cnn-with-opencv%2F&#038;format=xml" />

<!-- Theme version -->
<meta name="generator" content="Canvas 5.5.7" />
<meta name="generator" content="WooFramework 5.5.5" />

<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-color:#ffffff;background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:15px;padding-bottom:20px;border:0px solid ;}
#logo .site-title a {font:bold 32px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:300 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
#header-container{background-color:#ffffff;}#nav-container{background:#169fe6;}#nav-container{border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:none;border-right:none;}#nav-container #navigation ul#main-nav > li:first-child{border-left: 0px solid #dbdbdb;}#footer-widgets-container{background-color:#f0f0f0}#footer-widgets{border:none;}#footer-container{background-color:#169fe6}#footer-container{border-top:0px solid #dbdbdb;}#footer {border-width: 0 !important;}
body, p { font:300 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 2.2em/1.1em Arial, sans-serif;color:#3E3E3E;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#3E3E3E}
.post-meta { font:300 1em/1.5em Arial, sans-serif;color:#3E3E3E; }
.entry, .entry p{ font:300 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:300 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation .cart-contents, #navigation ul.rss, #navigation ul.cart .cart_list a{ font:300 13px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#ffffff; } #navigation ul.rss li a:before { color:#ffffff;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#169fe6!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart > li:hover, #navigation ul.cart > li > ul > div, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li > ul  { left: 0; }
#navigation  { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#169fe6;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:300 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:300 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#ffffff; }
#footer {background-color:#169fe6;border-top:0px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title, .magazine .block .post .title a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
</style>
<!-- Options Panel Custom CSS -->
<style type="text/css">
/* Subscribe & Connect button style */
#mc-embedded-subscribe{background-color: #DF4B4B;}

/* MailChimp for WP Plugin styles */
.mc4wp-form input[type=submit]{background-color: #DF4B4B;}

/* Hide the header/footer on almost finished pages */
.page-id-365 #header, .page-id-365 #nav-container, .page-id-365 #footer-container{display: none;}
.page-id-4031 #header, .page-id-4031 #nav-container, .page-id-4031 #footer-container{display: none;}
.page-id-365 #content{padding-top: 30px;}
.page-id-4031 #content{padding-top: 30px;}
.page-id-5289 #header, .page-id-5289 #nav-container, .page-id-5289 #footer-container{display: none;}
.page-id-5289 #content{padding-top: 30px;}

/* Hide the header/footer on confirmation pages */
.page-id-1397 #header, .page-id-1397 #nav-container, .page-id-1397 #footer-container{display: none;}
.page-id-1382 #header, .page-id-1382 #nav-container, .page-id-1382 #footer-container{display: none;}
.page-id-1481 #header, .page-id-1481 #nav-container, .page-id-1481 #footer-container{display: none;}
.page-id-3200 #header, .page-id-3200 #nav-container, .page-id-3200 #footer-container{display: none;}
.page-id-4038 #header, .page-id-4038 #nav-container, .page-id-4038 #footer-container{display: none;}
.page-id-5278 #header, .page-id-5278 #nav-container, .page-id-5278 #footer-container{display: none;}
.page-id-8101 #header, .page-id-8101 #nav-container, .page-id-8101 #footer-container{display: none;}
.page-id-1397 #content, .page-id-1382 #content, .page-id-1481 #content, .page-id-4038 #content, .page-id-5278 #content, .page-id-8101 #content{padding-top: 30px;}

/* Manipulate content on 'Let me show you...' page */
.page-id-3200 #content{padding-top: 15px;}
.page-id-3200 #content h1.title{display: none;}
.page-id-3200 #content .entry h1{font-size: 32px;}

/* Add margin to bottom of LaTeX equations, but only when they are not in paragraphs */
section.entry .latex{margin-bottom: 15px;}
section.entry p .latex{margin-bottom: 0px;}

/* Fix list specific issues on the "Start Here" page */
.page-id-4374 #start_here_benefits li{margin-bottom: 15px;}

/* Fix search icon */
button.icon-search.submit{margin-top: -7px;}
</style>


<!-- Woo Shortcodes CSS -->


<!-- Custom Stylesheet -->

<style type="text/css">
/* <![CDATA[ */
img.latex { vertical-align: middle; border: none; }
/* ]]> */
</style>

<!-- start Mixpanel -->
<script type="text/javascript">(function(f,b){if(!b.__SV){var a,e,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" ");
for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=f.createElement("script");a.type="text/javascript";a.async=!0;a.src="//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";e=f.getElementsByTagName("script")[0];e.parentNode.insertBefore(a,e)}})(document,window.mixpanel||[]);
mixpanel.init("2486e0f021e92605d44d32fce5f1d826");
</script>
<!-- end Mixpanel -->

</head>
<body class="post-template-default single single-post postid-8999 single-format-standard gecko alt-style-default two-col-left width-960 two-col-left-960 full-width full-header full-footer">
<div id="wrapper">

	<div id="inner-wrapper">

	    <!--#header-container-->
    <div id="header-container">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>

	<header id="header" class="col-full">

		<div id="logo">
<a href="https://www.pyimagesearch.com/" title="Be awesome at OpenCV, Python, deep learning, and computer vision"><img src="https://www.pyimagesearch.com/wp-content/uploads/2013/12/logo.png" alt="PyImageSearch" /></a>
<span class="site-title"><a href="https://www.pyimagesearch.com/">PyImageSearch</a></span>
<span class="site-description">Be awesome at OpenCV, Python, deep learning, and computer vision</span>
</div>

	</header>

	    </div><!--/#header-container-->
    <!--#nav-container-->
    <div id="nav-container">
<nav id="navigation" class="col-full" role="navigation">

	<section class="menus">

		<a href="https://www.pyimagesearch.com" class="nav-home"><span>Home</span></a>

	<h3>Main Menu</h3><ul id="main-nav" class="nav fl"><li id="menu-item-4519" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4519"><a href="https://www.pyimagesearch.com/start-here-learn-computer-vision-opencv/">Start Here</a></li>
<li id="menu-item-2616" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2616"><a href="https://www.pyimagesearch.com/practical-python-opencv/">Practical Python and OpenCV</a></li>
<li id="menu-item-2617" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2617"><a href="https://www.pyimagesearch.com/pyimagesearch-gurus/">PyImageSearch Gurus</a></li>
<li id="menu-item-2615" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2615"><a href="https://www.pyimagesearch.com/opencv-tutorials-resources-guides/">OpenCV 3 &#038; 4 Tutorials</a></li>
<li id="menu-item-2618" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2618"><a href="https://www.pyimagesearch.com/free-opencv-crash-course/">FREE OpenCV Course</a></li>
<li id="menu-item-2619" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2619"><a href="https://www.pyimagesearch.com/about/">About</a></li>
<li id="menu-item-6744" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6744"><a href="https://www.pyimagesearch.com/contact/">Contact</a></li>
</ul>
	</section><!-- /.menus -->

	<a href="#top" class="nav-close"><span>Return to Content</span></a>

</nav>
    </div><!--/#nav-container-->
       
    <!-- #content Starts -->
	    <div id="content" class="col-full">
    
    	<div id="main-sidebar-container">    

            <!-- #main Starts -->
                        <section id="main">                       
<article class="post-8999 post type-post status-publish format-standard hentry category-deep-learning-2 category-semantic-segmentation category-tutorials tag-deep-learning tag-instance-segmentation tag-mask-r-cnn tag-masks tag-object-detection tag-segmentation tag-semantic-segmentation">
	<header>
	<h1 class="title">Mask R-CNN with OpenCV</h1>	</header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://www.pyimagesearch.com/author/adrian/" title="Posts by Adrian Rosebrock" rel="author">Adrian Rosebrock</a></span></span> <span class="small">on</span> <abbr class="date time published" title="2018-11-19T10:00:10-0500">November 19, 2018</abbr>  <span class="small">in</span> <span class="categories"><a href="https://www.pyimagesearch.com/category/deep-learning-2/" title="View all items in Deep Learning">Deep Learning</a>, <a href="https://www.pyimagesearch.com/category/semantic-segmentation/" title="View all items in Semantic Segmentation">Semantic Segmentation</a>, <a href="https://www.pyimagesearch.com/category/tutorials/" title="View all items in Tutorials">Tutorials</a></span>  </div>
	<section class="entry">
<div id="fsb-social-bar" class="fsb-social-bar" data-post-id="8999" data-socialite="true"><style type="text/css">            #fsb-social-bar { width: 100%; border-bottom: 1px solid #dbdbdb; border-top: 1px solid #dbdbdb; padding: 10px 0; margin: 0px 0 20px 0; float: left; background: #fff; position: relative; clear: both; }            #fsb-social-bar a { border: 0px !important }            #fsb-social-bar.fsb-fixed { position: fixed; top: -2px; z-index: 99999; }            #fsb-social-bar .fsb-title { display: block; float: left; margin: 3px 20px 0 0; font-size: 16px; font-family: Arial, Helvetica, sans-serif; text-decoration: none; color: #333; }            #fsb-social-bar .fsb-share-facebook { width: 120px; float: left; padding: 3px 0 2px; height: 25px; }            #fsb-social-bar .fsb-share-facebook.fsb-hide-count { width: 44px; overflow: hidden; margin-right: 30px; }            #fsb-social-bar .fsb-share-twitter { float: left; width: 135px; padding: 3px 0 2px; height: 25px; }            #fsb-social-bar .fsb-share-twitter.fsb-hide-count { width: 61px; overflow: hidden; margin-right: 30px; }            #fsb-social-bar .fsb-share-google { float: left; width: 105px; padding: 3px 0 2px; height: 25px; }            #fsb-social-bar .fsb-share-google.fsb-hide-count { width: 33px; overflow: hidden; margin-right: 30px; }            #fsb-social-bar .fsb-share-linkedin { float: left; width: 135px; padding: 3px 0 2px; height: 25px; }            #fsb-social-bar .fsb-share-linkedin.fsb-hide-count { width: 61px; overflow: hidden; margin-right: 30px; }            #fsb-social-bar .fsb-share-pinterest { float: left; width: 115px; padding: 3px 0 2px; height: 25px;}            #fsb-social-bar .fsb-share-pinterest.fsb-hide-count { width: 43px; overflow: hidden; margin-right: 30px; }            #fsb-social-bar .socialite { display: block; position: relative; background: url(https://www.pyimagesearch.com/wp-content/plugins/floating-social-bar/images/fsb-sprite.png) no-repeat scroll 0 0; }            #fsb-social-bar .socialite-loaded { background: none !important; }            #fsb-social-bar .fsb-service-title { display: none; }            #fsb-social-bar a { color: #333; text-decoration: none; font-size: 12px; font-family: Arial, Helvetica, sans-serif; }            #fsb-social-bar .fsb-twitter { width: 105px; height: 25px; background-position: -13px -10px; line-height: 25px; vertical-align: middle; }            #fsb-social-bar .fsb-twitter .fsb-count { width: 30px; text-align: center; display: inline-block; margin: 0px 0 0 69px; color: #333; }            #fsb-social-bar .fsb-google { width: 75px; height: 25px; background-position: -136px -10px; line-height: 25px; vertical-align: middle; }            #fsb-social-bar .fsb-google .fsb-count { width: 30px; text-align: center; display: inline-block; margin: 0px 0 0 41px; color: #333; }            #fsb-social-bar .fsb-google .socialite-button { margin: 0 !important; }            #fsb-social-bar .fsb-share-google .socialite-loaded .socialite-button{padding: 2px 0 0}            #fsb-social-bar .fsb-facebook { width: 89px; height: 25px; background-position: -231px -10px; line-height: 25px; vertical-align: middle; }            #fsb-social-bar .fsb-facebook .fsb-count { width: 30px; text-align: center; display: inline-block; margin: 0px 0 0 52px; color: #333; }            #fsb-social-bar .fsb-facebook .socialite-button { margin: 0 !important;}            #fsb-social-bar .fsb-share-facebook .socialite-loaded .socialite-button {padding: 2px 0 0}            #fsb-social-bar .fsb-linkedin { width: 105px; height: 25px; background-position: -347px -10px; line-height: 25px; vertical-align: middle; }            #fsb-social-bar .fsb-linkedin .fsb-count { width: 30px; text-align: center; display: inline-block; margin: 0px 0 0 70px; color: #333; }            #fsb-social-bar .fsb-linkedin .socialite-button { margin: 0 !important; }            #fsb-social-bar .fsb-pinterest { width: 88px; height: 25px; background-position: -484px -10px; line-height: 25px; vertical-align: middle; }            #fsb-social-bar .fsb-pinterest .fsb-count { width: 30px; text-align: center; display: inline-block; margin: 0px 0 0 50px; color: #333; }            #fsb-social-bar .fsb-pinterest .socialite-button { margin: 0 !important; }            .fsb-clear { clear: both; }            .fsb-clear:after { clear:both; content:; display:block; height:0; line-height:0; overflow:auto; visibility:hidden; zoom:1; }            @media (max-width: 768px) { #fsb-social-bar.fsb-fixed { position: relative !important; top: auto !important; } }        </style>
            <a target="_blank" href="https://app.monstercampaigns.com/c/ryzsxelnx6msppzfoy6p/" class="manual-optin-trigger" data-optin-slug="ryzsxelnx6msppzfoy6p" style="display: block;">
                <div style="font-size: 14pt; color: #21212A;">
                    <img src="https://www.pyimagesearch.com/static/optins/python_icon.png" alt="" style="margin-right: 10px; width: 40px; height: 40px; float: left; border: none;" />
                    <div style="padding-top: 10px;">
                        <span style="font-weight: bold; color: #DF4B4B; text-decoration: underline;">Click here to download the source code to this post.</span>
                    </div>
                </div>
            </a>
        </div><div class="fsb-clear"></div><p><img class="aligncenter size-full" src="https://s3-us-west-2.amazonaws.com/static.pyimagesearch.com/opencv-mask-rcnn/mask_rcnn_example03.gif" width="500" /></p>
<p>In this tutorial, you will learn how to use Mask R-CNN with OpenCV.</p>
<p><strong>Using Mask R-CNN you can automatically segment and construct pixel-wise masks for every object in an image.</strong> We’ll be applying Mask R-CNNs to both images and video streams.</p>
<p>In last week’s blog post you learned how to use the <a href="https://www.pyimagesearch.com/2018/11/12/yolo-object-detection-with-opencv/" target="_blank" rel="noopener">YOLO object detector</a> to detect the presence of objects in images. Object detectors, such as YOLO, Faster R-CNNs, and Single Shot Detectors (SSDs), generate four sets of <em>(x, y)</em>-coordinates which represent the <em>bounding box</em> of an object in an image.</p>
<p>Obtaining the bounding boxes of an object is a good start but the bounding box itself doesn’t tell us anything about (1) which pixels belong to the foreground object and (2) which pixels belong to the background.</p>
<p>That begs the question:</p>
<blockquote><p><strong>Is it possible to generate a <em>mask</em> for each object in our image, thereby allowing us to <em>segment</em> the foreground object from the background?</strong></p>
<p>Is such a method even possible?</p></blockquote>
<p><strong>The answer is yes</strong> &#8212; we just need to perform <em>instance segmentation</em> using the Mask R-CNN architecture.</p>
<p><strong>To learn how to apply Mask R-CNN with OpenCV to both images and video streams, <em>just keep reading!</em></strong></p>
<div style="padding-top: 10px; padding-bottom: 15px; padding-right: 10px; height: 70px; background: url('https://www.pyimagesearch.com/wp-content/uploads/2014/02/download-code-icon.png'); background-size: 70px 70px; background-repeat: no-repeat;">
<p style="margin-top: 1px; margin-left: 80px; font-weight: bold;">Looking for the source code to this post?<br />
<a id="scroll_to_code" href="#">Jump right to the downloads section.</a></p>
</div>
<h2>Mask R-CNN with OpenCV</h2>
<p>In the first part of this tutorial, we’ll discuss the difference between <em>image classification</em>, <em>object detection,</em> <em>instance segmentation,</em> and <em>semantic segmentation</em>.</p>
<p>From there we’ll briefly review the Mask R-CNN architecture and its connections to Faster R-CNN.</p>
<p>I’ll then show you how to apply Mask R-CNN with OpenCV to both images and video streams.</p>
<p>Let’s get started!</p>
<h3>Instance segmentation vs. Semantic segmentation</h3>
<div id="attachment_9031" style="max-width: 610px" class="wp-caption aligncenter"><a href="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_segmentation_types.jpg"><img class="size-full wp-image-9031" src="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_segmentation_types.jpg" alt="" width="600" height="479" srcset="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_segmentation_types.jpg 600w, https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_segmentation_types-300x240.jpg 300w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><strong>Figure 1:</strong> Image classification (<em>top-left</em>), object detection (<em>top-right</em>), semantic segmentation (<em>bottom-left</em>), and instance segmentation (<em>bottom-right</em>). We’ll be performing instance segmentation with Mask R-CNN in this tutorial. (<a href="https://arxiv.org/abs/1704.06857" target="_blank" rel="noopener">source</a>)</p></div>
<p>Explaining the differences between traditional image classification, object detection, semantic segmentation, and instance segmentation is best done visually.</p>
<p>When performing traditional <em><strong>image classification</strong></em> our goal is to predict a set of labels to characterize the contents of an input image (<em>top-left</em>).</p>
<p><em><strong>Object detection</strong></em> builds on image classification, but this time allows us to localize each object in an image. The image is now characterized by:</p>
<ol>
<li>Bounding box <em>(x, y)</em>-coordinates for each object</li>
<li>An associated <em>class label</em> for each bounding box</li>
</ol>
<p>An example of <em><strong>semantic segmentation</strong></em> can be seen in <em>bottom-left</em>. Semantic segmentation algorithms require us to associate <em>every pixel</em> in an input image with a class label (including a class label for the background).</p>
<p>Pay close attention to our semantic segmentation visualization &#8212; notice how each object is indeed segmented but each “cube” object has the same color.</p>
<p>While semantic segmentation algorithms are capable of labeling every object in an image they <em>cannot</em> differentiate between two objects of the same class.</p>
<p>This behavior is especially problematic if two objects of the same class are partially occluding each other &#8212; we have no idea where the boundaries of one object ends and the next one begins, as demonstrated by the two purple cubes, we cannot tell where one cube starts and the other ends.</p>
<p><em><strong>Instance segmentation</strong></em> algorithms, on the other hand, compute a pixel-wise mask for every object in the image, even if the objects are of the same class label (<em>bottom-right</em>). Here you can see that each of the cubes has their own unique color, implying that our instance segmentation algorithm not only localized each individual cube but predicted their boundaries as well.</p>
<p>The Mask R-CNN architecture we’ll be discussing in this tutorial is an example of an <em><strong>instance segmentation</strong></em> algorithm.</p>
<h3>What is Mask R-CNN?</h3>
<p>The Mask R-CNN algorithm was introduced by He et al. in their 2017 paper, <a href="https://arxiv.org/abs/1703.06870" target="blank" rel="noopener"><em>Mask R-CNN</em></a>.</p>
<p>Mask R-CNN builds on the previous object detection work of <a href="https://arxiv.org/abs/1311.2524" target="blank" rel="noopener"><em>R-CNN</em></a> (2013), <a href="https://arxiv.org/abs/1504.08083" target="blank" rel="noopener"><em>Fast R-CNN</em></a> (2015), and <a href="https://arxiv.org/abs/1506.01497" target="blank" rel="noopener"><em>Faster R-CNN</em></a> (2015), all by Girshick et al.</p>
<p>In order to understand Mask R-CNN let’s briefly review the R-CNN variants, starting with the original R-CNN:</p>
<div id="attachment_9032" style="max-width: 610px" class="wp-caption aligncenter"><a href="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_rcn_orig.jpg"><img class="size-full wp-image-9032" src="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_rcn_orig.jpg" alt="" width="600" height="221" srcset="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_rcn_orig.jpg 600w, https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_rcn_orig-300x111.jpg 300w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><strong>Figure 2:</strong> The original R-CNN architecture (source: <a href="https://arxiv.org/abs/1311.2524" target="blank" rel="noopener">Girshick et al,. 2013</a>)</p></div>
<p>The original R-CNN algorithm is a four-step process:</p>
<ul>
<li><strong>Step #1:</strong> Input an image to the network.</li>
<li><strong>Step #2:</strong> Extract region proposals (i.e., regions of an image that potentially contain objects) using an algorithm such as <a href="http://www.huppelen.nl/publications/selectiveSearchDraft.pdf" target="blank" rel="noopener">Selective Search</a>.</li>
<li><strong>Step #3:</strong> Use transfer learning, specifically feature extraction, to compute features for each proposal (which is effectively an ROI) using the pre-trained CNN.</li>
<li><strong>Step #4:</strong> Classify each proposal using the extracted features with a Support Vector Machine (SVM).</li>
</ul>
<p>The reason this method works is due to the robust, discriminative features learned by the CNN.</p>
<p><strong>However, the problem with the R-CNN method is it’s incredibly slow.</strong> And furthermore, we’re not actually learning to localize via a deep neural network, we’re effectively just building a more advanced <a href="https://www.pyimagesearch.com/2014/11/10/histogram-oriented-gradients-object-detection/" target="blank" rel="noopener">HOG + Linear SVM detector</a>.</p>
<p>To improve upon the original R-CNN, Girshick et al. published the <em>Fast R-CNN</em> algorithm:</p>
<div id="attachment_9033" style="max-width: 610px" class="wp-caption aligncenter"><a href="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_fast_rcnn.jpg"><img class="size-full wp-image-9033" src="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_fast_rcnn.jpg" alt="" width="600" height="240" srcset="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_fast_rcnn.jpg 600w, https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_fast_rcnn-300x120.jpg 300w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><strong>Figure 3:</strong> The Fast R-CNN architecture (source: <a href="https://arxiv.org/abs/1504.08083" target="blank" rel="noopener">Girshick et al., 2015</a>).</p></div>
<p>Similar to the original R-CNN, Fast R-CNN still utilizes Selective Search to obtain region proposals; however, the novel contribution from the paper was <strong>Region of Interest (ROI) Pooling module</strong>.</p>
<p>ROI Pooling works by extracting a fixed-size window from the feature map and using these features to obtain the final class label and bounding box. <strong>The primary benefit here is that the network is now, effectively, end-to-end trainable:</strong></p>
<ol>
<li>We input an image and associated ground-truth bounding boxes</li>
<li>Extract the feature map</li>
<li>Apply ROI pooling and obtain the ROI feature vector</li>
<li>And finally, use the two sets of fully-connected layers to obtain (1) the class label predictions and (2) the bounding box locations for each proposal.</li>
</ol>
<p>While the network is now end-to-end trainable, performance suffered dramatically at inference (i.e., prediction) by being dependent on Selective Search.</p>
<p>To make the R-CNN architecture even <em>faster</em> we need to incorporate the region proposal <em>directly</em> into the R-CNN:</p>
<div id="attachment_9034" style="max-width: 610px" class="wp-caption aligncenter"><a href="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnns_faster_rcnn.jpg"><img class="size-full wp-image-9034" src="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnns_faster_rcnn.jpg" alt="" width="600" height="588" srcset="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnns_faster_rcnn.jpg 600w, https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnns_faster_rcnn-300x294.jpg 300w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><strong>Figure 4:</strong> The Faster R-CNN architecture (source: <a href="https://arxiv.org/abs/1506.01497" target="blank" rel="noopener">Girshick et al., 2015</a>)</p></div>
<p>The <em>Faster R-CNN</em> paper by Girshick et al. introduced the <strong>Region Proposal Network (RPN)</strong> that bakes region proposal <em>directly</em> into the architecture, alleviating the need for the Selective Search algorithm.</p>
<p>As a whole, the Faster R-CNN architecture is capable of running at approximately 7-10 FPS, a huge step towards making real-time object detection with deep learning a reality.</p>
<p><strong>The Mask R-CNN algorithm builds on the Faster R-CNN architecture with two major contributions:</strong></p>
<ol>
<li>Replacing the ROI Pooling module with a more accurate ROI Align module</li>
<li>Inserting an additional branch out of the ROI Align module</li>
</ol>
<p>This additional branch accepts the output of the ROI Align and then feeds it into two CONV layers.</p>
<p>The output of the CONV layers is the mask itself.</p>
<p>We can visualize the Mask R-CNN architecture in the following figure:</p>
<div id="attachment_9035" style="max-width: 610px" class="wp-caption aligncenter"><a href="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_arch.png"><img class="size-full wp-image-9035" src="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_arch.png" alt="" width="600" height="327" srcset="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_arch.png 600w, https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_arch-300x164.png 300w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><strong>Figure 5:</strong> The Mask R-CNN work by He et al. replaces the ROI Polling module with a more accurate ROI Align module. The output of the ROI module is then fed into two CONV layers. The output of the CONV layers is the mask itself.</p></div>
<p><strong>Notice the branch of two CONV layers coming out of the ROI Align module &#8212; this is where our mask is actually generated.</strong></p>
<p>As we know, the Faster R-CNN/Mask R-CNN architectures leverage a Region Proposal Network (RPN) to generate regions of an image that <em>potentially</em> contain an object.</p>
<p>Each of these regions is ranked based on their “objectness score” (i.e., how likely it is that a given region could potentially contain an object) and then the top <em>N</em> most confident objectness regions are kept.</p>
<p>In the original Faster R-CNN publication Girshick et al. set <em>N=2,000</em>, but in practice, we can get away with a much smaller N, such as <em>N={10, 100, 200, 300}</em> and still obtain good results.</p>
<p>He et al. set <em>N=300</em> in <a href="https://arxiv.org/abs/1703.06870" target="blank" rel="noopener">their publication</a> which is the value we’ll use here as well.</p>
<p>Each of the 300 selected ROIs go through three parallel branches of the network:</p>
<ol>
<li>Label prediction</li>
<li>Bounding box prediction</li>
<li>Mask prediction</li>
</ol>
<p><strong>Figure 5</strong> above above visualizes these branches.</p>
<p>During prediction, each of the 300 ROIs go through <a href="https://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/" target="blank" rel="noopener">non-maxima suppression</a> and the top 100 detection boxes are kept, resulting in a 4D tensor of <em>100 x L x 15 x 15</em> where <em>L</em> is the number of class labels in the dataset and <em>15 x 15</em> is the size of each of the <em>L</em> masks.</p>
<p>The Mask R-CNN we’re using here today was trained on the <a href="http://cocodataset.org/#home" target="_blank" rel="noopener">COCO dataset</a>, which has <em>L=90</em> classes, thus the resulting volume size from the mask module of the Mask R CNN is <em>100 x 90 x 15 x 15.</em></p>
<p>To visualize the Mask R-CNN process take a look at the figure below:</p>
<div id="attachment_9036" style="max-width: 610px" class="wp-caption aligncenter"><a href="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_mask_resizing.jpg"><img class="size-full wp-image-9036" src="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_mask_resizing.jpg" alt="" width="600" height="462" srcset="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_mask_resizing.jpg 600w, https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_mask_resizing-300x231.jpg 300w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><strong>Figure 6:</strong> A visualization of Mask R-CNN producing a <em>15 x 15</em> mask, the mask resized to the original dimensions of the image, and then finally overlaying the mask on the original image. (source: <a href="https://www.pyimagesearch.com/deep-learning-computer-vision-python-book/" target="blank" rel="noopener"><em>Deep Learning for Computer Vision with Python</em></a>, ImageNet Bundle)</p></div>
<p>Here you can see that we start with our input image and feed it through our Mask R-CNN network to obtain our mask prediction.</p>
<p>The predicted mask is only <em>15 x 15</em> pixels so we resize the mask back to the original input image dimensions.</p>
<p>Finally, the resized mask can be overlaid on the original input image. For a more thorough discussion on how Mask R-CNN works be sure to refer to:</p>
<ol>
<li>The original <a href="https://arxiv.org/abs/1703.06870" target="blank" rel="noopener"><em>Mask R-CNN</em></a> publication by He et al.</li>
<li>My book, <a href="https://www.pyimagesearch.com/deep-learning-computer-vision-python-book/" target="blank" rel="noopener"><em>Deep Learning for Computer Vision with Python</em></a>, where I discuss Mask R-CNNs in more detail, <strong>including how to train your own Mask R-CNNs from scratch on your own data.</strong></li>
</ol>
<h3>Project structure</h3>
<p>Our project today consists of two scripts, but there are several other files that are important.</p>
<p>I&#8217;ve organized the project in the following manner (as is shown by the 
			<span id="crayon-5c05221c3289d051013086" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">tree</span></span></span>  command output directly in a terminal):</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c328b1860401206" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$ tree
.
├── mask-rcnn-coco
│   ├── colors.txt
│   ├── frozen_inference_graph.pb
│   ├── mask_rcnn_inception_v2_coco_2018_01_28.pbtxt
│   └── object_detection_classes_coco.txt
├── images
│   ├── example_01.jpg
│   ├── example_02.jpg
│   └── example_03.jpg
├── videos
│   ├── 
├── output
│   ├──  
├── mask_rcnn.py
└── mask_rcnn_video.py

4 directories, 9 files</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c328b1860401206-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c328b1860401206-2">2</div><div class="crayon-num" data-line="crayon-5c05221c328b1860401206-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c328b1860401206-4">4</div><div class="crayon-num" data-line="crayon-5c05221c328b1860401206-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c328b1860401206-6">6</div><div class="crayon-num" data-line="crayon-5c05221c328b1860401206-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c328b1860401206-8">8</div><div class="crayon-num" data-line="crayon-5c05221c328b1860401206-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c328b1860401206-10">10</div><div class="crayon-num" data-line="crayon-5c05221c328b1860401206-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c328b1860401206-12">12</div><div class="crayon-num" data-line="crayon-5c05221c328b1860401206-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c328b1860401206-14">14</div><div class="crayon-num" data-line="crayon-5c05221c328b1860401206-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c328b1860401206-16">16</div><div class="crayon-num" data-line="crayon-5c05221c328b1860401206-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c328b1860401206-18">18</div><div class="crayon-num" data-line="crayon-5c05221c328b1860401206-19">19</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c328b1860401206-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-i">tree</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c328b1860401206-2"><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5c05221c328b1860401206-3">├──<span class="crayon-h"> </span><span class="crayon-v">mask</span><span class="crayon-o">-</span><span class="crayon-v">rcnn</span><span class="crayon-o">-</span><span class="crayon-i">coco</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c328b1860401206-4">│  <span class="crayon-h"> </span>├──<span class="crayon-h"> </span><span class="crayon-v">colors</span><span class="crayon-e">.txt</span></div><div class="crayon-line" id="crayon-5c05221c328b1860401206-5">│  <span class="crayon-h"> </span>├──<span class="crayon-h"> </span><span class="crayon-v">frozen_inference_graph</span><span class="crayon-e">.pb</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c328b1860401206-6">│  <span class="crayon-h"> </span>├──<span class="crayon-h"> </span><span class="crayon-v">mask_rcnn_inception_v2_coco_2018_01_28</span><span class="crayon-e">.pbtxt</span></div><div class="crayon-line" id="crayon-5c05221c328b1860401206-7">│  <span class="crayon-h"> </span>└──<span class="crayon-h"> </span><span class="crayon-v">object_detection_classes_coco</span><span class="crayon-e">.txt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c328b1860401206-8">├──<span class="crayon-h"> </span><span class="crayon-i">images</span></div><div class="crayon-line" id="crayon-5c05221c328b1860401206-9">│  <span class="crayon-h"> </span>├──<span class="crayon-h"> </span><span class="crayon-v">example_01</span><span class="crayon-e">.jpg</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c328b1860401206-10">│  <span class="crayon-h"> </span>├──<span class="crayon-h"> </span><span class="crayon-v">example_02</span><span class="crayon-e">.jpg</span></div><div class="crayon-line" id="crayon-5c05221c328b1860401206-11">│  <span class="crayon-h"> </span>└──<span class="crayon-h"> </span><span class="crayon-v">example_03</span><span class="crayon-e">.jpg</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c328b1860401206-12">├──<span class="crayon-h"> </span><span class="crayon-i">videos</span></div><div class="crayon-line" id="crayon-5c05221c328b1860401206-13">│  <span class="crayon-h"> </span>├──<span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c328b1860401206-14">├──<span class="crayon-h"> </span><span class="crayon-i">output</span></div><div class="crayon-line" id="crayon-5c05221c328b1860401206-15">│  <span class="crayon-h"> </span>├──<span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c328b1860401206-16">├──<span class="crayon-h"> </span><span class="crayon-v">mask_rcnn</span><span class="crayon-e">.py</span></div><div class="crayon-line" id="crayon-5c05221c328b1860401206-17">└──<span class="crayon-h"> </span><span class="crayon-v">mask_rcnn_video</span><span class="crayon-e">.py</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c328b1860401206-18">&nbsp;</div><div class="crayon-line" id="crayon-5c05221c328b1860401206-19"><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-v">directories</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-h"> </span><span class="crayon-v">files</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0025 seconds] -->
<p>Our project consists of four directories:</p>
<ul>
<li>
			<span id="crayon-5c05221c328b6585382051" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">mask</span><span class="crayon-o">-</span><span class="crayon-v">rcnn</span><span class="crayon-o">-</span><span class="crayon-v">coco</span><span class="crayon-o">/</span></span></span> : The Mask R-CNN model files. There are four files:
<ul>
<li>
			<span id="crayon-5c05221c328bb913781420" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">frozen_inference_graph</span><span class="crayon-e">.pb</span></span></span> : The Mask R-CNN model weights. The weights are pre-trained on the COCO dataset.</li>
<li>
			<span id="crayon-5c05221c328bf525660899" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">mask_rcnn_inception_v2_coco_2018_01_28</span><span class="crayon-e">.pbtxt</span></span></span> : The Mask R-CNN model configuration. If you&#8217;d like to build + train your own model on your own annotated data, refer to <em><a href="https://www.pyimagesearch.com/deep-learning-computer-vision-python-book/" target="_blank" rel="noopener">Deep Learning for Computer Vision with Python</a>.</em></li>
<li>
			<span id="crayon-5c05221c328c4910993634" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">object_detection_classes_coco</span><span class="crayon-e">.txt</span></span></span> : All 90 classes are listed in this text file, one per line. Open it in a text editor to see what objects our model can recognize.</li>
<li>
			<span id="crayon-5c05221c328c8496858250" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">colors</span><span class="crayon-e">.txt</span></span></span> : This text file contains six colors to randomly assign to objects found in the image.</li>
</ul>
</li>
<li>
			<span id="crayon-5c05221c328cc343042981" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">images</span><span class="crayon-o">/</span></span></span> : I&#8217;ve provided three test images in the <em><strong>&#8220;Downloads&#8221;</strong></em>. Feel free to add your own images to test with.</li>
<li>
			<span id="crayon-5c05221c328d1358194731" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">videos</span><span class="crayon-o">/</span></span></span> : This is an empty directory. I actually tested with large videos that I scraped from YouTube (credits are below, just above the <em>&#8220;Summary&#8221;</em> section). Rather than providing a really big zip, my suggestion is that you find a few videos on YouTube to download and test with. Or maybe take some videos with your cell phone and come back to your computer and use them!</li>
<li>
			<span id="crayon-5c05221c328d5336559095" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">output</span><span class="crayon-o">/</span></span></span> : Another empty directory that will hold the processed videos (assuming you set the command line argument flag to output to this directory).</li>
</ul>
<p>We&#8217;ll be reviewing two scripts today:</p>
<ul>
<li>
			<span id="crayon-5c05221c328d9674764392" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">mask_rcnn</span><span class="crayon-e">.py</span></span></span> : This script will perform instance segmentation and apply a mask to the image so you can see where, down to the pixel, the Mask R-CNN thinks an object is.</li>
<li>
			<span id="crayon-5c05221c328dd276267963" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">mask_rcnn_video</span><span class="crayon-e">.py</span></span></span> : This video processing script uses the same Mask R-CNN and applies the model to every frame of a video file. The script then writes the output frame back to a video file on disk.</li>
</ul>
<h3>OpenCV and Mask R-CNN in images</h3>
<p>Now that we’ve reviewed how Mask R-CNNs work, let’s get our hands dirty with some Python code.</p>
<p>Before we begin, ensure that your Python environment has OpenCV 3.4.2/3.4.3 or higher installed. You can follow one of my <a href="https://www.pyimagesearch.com/opencv-tutorials-resources-guides/" target="blank" rel="noopener">OpenCV installation tutorials</a> to upgrade/install OpenCV. If you want to be up and running in 5 minutes or less, you can consider <a href="https://www.pyimagesearch.com/2018/09/19/pip-install-opencv/" target="blank" rel="noopener">installing OpenCV with pip</a>. If you have some other requirements, you might want to compile OpenCV from source.</p>
<p>Make sure you’ve used the <em><strong>“Downloads”</strong></em> section of this blog post to download the source code, trained Mask R-CNN, and example images.</p>
<p>From there, open up the 
			<span id="crayon-5c05221c328e2036782506" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">mask_rcnn</span><span class="crayon-e">.py</span></span></span>  file and insert the following code:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c328e7070346296" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# import the necessary packages
import numpy as np
import argparse
import random
import time
import cv2
import os</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c328e7070346296-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c328e7070346296-2">2</div><div class="crayon-num" data-line="crayon-5c05221c328e7070346296-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c328e7070346296-4">4</div><div class="crayon-num" data-line="crayon-5c05221c328e7070346296-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c328e7070346296-6">6</div><div class="crayon-num" data-line="crayon-5c05221c328e7070346296-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c328e7070346296-1"><span class="crayon-c"># import the necessary packages</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c328e7070346296-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></div><div class="crayon-line" id="crayon-5c05221c328e7070346296-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c328e7070346296-4"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">random</span></div><div class="crayon-line" id="crayon-5c05221c328e7070346296-5"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">time</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c328e7070346296-6"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">cv2</span></div><div class="crayon-line" id="crayon-5c05221c328e7070346296-7"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">os</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>First we&#8217;ll import our required packages on <strong>Lines 2-7</strong>. Notably, we&#8217;re importing NumPy and OpenCV. Everything else comes with most Python installations.</p>
<p>From there, we&#8217;ll parse our <a href="https://www.pyimagesearch.com/2018/03/12/python-argparse-command-line-arguments/" target="blank" rel="noopener">command line arguments</a>:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c328eb174546509" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# construct the argument parse and parse the arguments
ap = argparse.ArgumentParser()
ap.add_argument("-i", "--image", required=True,
	help="path to input image")
ap.add_argument("-m", "--mask-rcnn", required=True,
	help="base path to mask-rcnn directory")
ap.add_argument("-v", "--visualize", type=int, default=0,
	help="whether or not we are going to visualize each instance")
ap.add_argument("-c", "--confidence", type=float, default=0.5,
	help="minimum probability to filter weak detections")
ap.add_argument("-t", "--threshold", type=float, default=0.3,
	help="minimum threshold for pixel-wise mask segmentation")
args = vars(ap.parse_args())</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c328eb174546509-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c328eb174546509-10">10</div><div class="crayon-num" data-line="crayon-5c05221c328eb174546509-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c328eb174546509-12">12</div><div class="crayon-num" data-line="crayon-5c05221c328eb174546509-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c328eb174546509-14">14</div><div class="crayon-num" data-line="crayon-5c05221c328eb174546509-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c328eb174546509-16">16</div><div class="crayon-num" data-line="crayon-5c05221c328eb174546509-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c328eb174546509-18">18</div><div class="crayon-num" data-line="crayon-5c05221c328eb174546509-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c328eb174546509-20">20</div><div class="crayon-num" data-line="crayon-5c05221c328eb174546509-21">21</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c328eb174546509-9"><span class="crayon-c"># construct the argument parse and parse the arguments</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c328eb174546509-10"><span class="crayon-v">ap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span><span class="crayon-sy">.</span><span class="crayon-e">ArgumentParser</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c328eb174546509-11"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-i"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--image"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c328eb174546509-12"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to input image"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c328eb174546509-13"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-m"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--mask-rcnn"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c328eb174546509-14"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"base path to mask-rcnn directory"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c328eb174546509-15"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-v"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--visualize"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">type</span><span class="crayon-o">=</span><span class="crayon-k ">int</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">default</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c328eb174546509-16"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"whether or not we are going to visualize each instance"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c328eb174546509-17"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-c"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--confidence"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">type</span><span class="crayon-o">=</span><span class="crayon-k ">float</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">default</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c328eb174546509-18"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"minimum probability to filter weak detections"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c328eb174546509-19"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-t"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--threshold"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">type</span><span class="crayon-o">=</span><span class="crayon-k ">float</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">default</span><span class="crayon-o">=</span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c328eb174546509-20"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"minimum threshold for pixel-wise mask segmentation"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c328eb174546509-21"><span class="crayon-v">args</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">vars</span><span class="crayon-sy">(</span><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">parse_args</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0056 seconds] -->
<p>Our script requires that command line argument flags and parameters be passed at runtime in our terminal. Our arguments are parsed on <strong>Lines 10-21</strong>, where the first two of the following are required and the rest are optional:</p>
<ul>
<li>
			<span id="crayon-5c05221c328f0285576774" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">image</span></span></span> : The path to our input image.</li>
<li>
			<span id="crayon-5c05221c328f4870531221" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">mask</span><span class="crayon-o">-</span><span class="crayon-v">rnn</span></span></span> : The base path to the Mask R-CNN files.</li>
<li>
			<span id="crayon-5c05221c328f8276299796" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">visualize</span></span></span>  (optional): A positive value indicates that we want to visualize how we extracted the masked region on our screen. Either way, we&#8217;ll display the final output on the screen.</li>
<li>
			<span id="crayon-5c05221c328fd232304053" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">confidence</span></span></span>  (optional): You can override the probability value of 
			<span id="crayon-5c05221c32901171658995" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-cn">0.5</span></span></span>  which serves to filter weak detections.</li>
<li>
			<span id="crayon-5c05221c32905559653457" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">threshold</span></span></span>  (optional): We&#8217;ll be creating a binary mask for each object in the image and this threshold value will help us filter out weak mask predictions. I found that a default value of 
			<span id="crayon-5c05221c32909738694666" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-cn">0.3</span></span></span>  works pretty well.</li>
</ul>
<p>Now that our command line arguments are stored in the 
			<span id="crayon-5c05221c3290d707240516" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">args</span></span></span>  dictionary, let&#8217;s load our labels and colors:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c32911548451290" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# load the COCO class labels our Mask R-CNN was trained on
labelsPath = os.path.sep.join([args["mask_rcnn"],
	"object_detection_classes_coco.txt"])
LABELS = open(labelsPath).read().strip().split("\n")

# load the set of colors that will be used when visualizing a given
# instance segmentation
colorsPath = os.path.sep.join([args["mask_rcnn"], "colors.txt"])
COLORS = open(colorsPath).read().strip().split("\n")
COLORS = [np.array(c.split(",")).astype("int") for c in COLORS]
COLORS = np.array(COLORS, dtype="uint8")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c32911548451290-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32911548451290-24">24</div><div class="crayon-num" data-line="crayon-5c05221c32911548451290-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32911548451290-26">26</div><div class="crayon-num" data-line="crayon-5c05221c32911548451290-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32911548451290-28">28</div><div class="crayon-num" data-line="crayon-5c05221c32911548451290-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32911548451290-30">30</div><div class="crayon-num" data-line="crayon-5c05221c32911548451290-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32911548451290-32">32</div><div class="crayon-num" data-line="crayon-5c05221c32911548451290-33">33</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c32911548451290-23"><span class="crayon-c"># load the COCO class labels our Mask R-CNN was trained on</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32911548451290-24"><span class="crayon-v">labelsPath</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-v">sep</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"mask_rcnn"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c05221c32911548451290-25"><span class="crayon-h">	</span><span class="crayon-s">"object_detection_classes_coco.txt"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32911548451290-26"><span class="crayon-v">LABELS</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-v">labelsPath</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">strip</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">"\n"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c32911548451290-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32911548451290-28"><span class="crayon-c"># load the set of colors that will be used when visualizing a given</span></div><div class="crayon-line" id="crayon-5c05221c32911548451290-29"><span class="crayon-c"># instance segmentation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32911548451290-30"><span class="crayon-v">colorsPath</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-v">sep</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"mask_rcnn"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"colors.txt"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c32911548451290-31"><span class="crayon-v">COLORS</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-v">colorsPath</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">strip</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">"\n"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32911548451290-32"><span class="crayon-v">COLORS</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">","</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">"int"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">COLORS</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c05221c32911548451290-33"><span class="crayon-v">COLORS</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-v">COLORS</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-s">"uint8"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0034 seconds] -->
<p><strong>Lines 24-26</strong> load the COCO object class 
			<span id="crayon-5c05221c32916242613352" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">LABELS</span></span></span> . Today&#8217;s Mask R-CNN is capable of recognizing 90 classes including people, vehicles, signs, animals, everyday items, sports gear, kitchen items, food, and more! I encourage you to look at 
			<span id="crayon-5c05221c3291b040659742" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">object_detection_classes_coco</span><span class="crayon-e">.txt</span></span></span>  to see the available classes.</p>
<p>From there we load the 
			<span id="crayon-5c05221c3291f609675410" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">COLORS</span></span></span>  from the path, performing a couple array conversion operations (<strong>Lines 30-33</strong>).</p>
<p>Let&#8217;s load our model:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c32923238830886" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# derive the paths to the Mask R-CNN weights and model configuration
weightsPath = os.path.sep.join([args["mask_rcnn"],
	"frozen_inference_graph.pb"])
configPath = os.path.sep.join([args["mask_rcnn"],
	"mask_rcnn_inception_v2_coco_2018_01_28.pbtxt"])

# load our Mask R-CNN trained on the COCO dataset (90 classes)
# from disk
print("[INFO] loading Mask R-CNN from disk...")
net = cv2.dnn.readNetFromTensorflow(weightsPath, configPath)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c32923238830886-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32923238830886-36">36</div><div class="crayon-num" data-line="crayon-5c05221c32923238830886-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32923238830886-38">38</div><div class="crayon-num" data-line="crayon-5c05221c32923238830886-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32923238830886-40">40</div><div class="crayon-num" data-line="crayon-5c05221c32923238830886-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32923238830886-42">42</div><div class="crayon-num" data-line="crayon-5c05221c32923238830886-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32923238830886-44">44</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c32923238830886-35"><span class="crayon-c"># derive the paths to the Mask R-CNN weights and model configuration</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32923238830886-36"><span class="crayon-v">weightsPath</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-v">sep</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"mask_rcnn"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c05221c32923238830886-37"><span class="crayon-h">	</span><span class="crayon-s">"frozen_inference_graph.pb"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32923238830886-38"><span class="crayon-v">configPath</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-v">sep</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"mask_rcnn"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c05221c32923238830886-39"><span class="crayon-h">	</span><span class="crayon-s">"mask_rcnn_inception_v2_coco_2018_01_28.pbtxt"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32923238830886-40">&nbsp;</div><div class="crayon-line" id="crayon-5c05221c32923238830886-41"><span class="crayon-c"># load our Mask R-CNN trained on the COCO dataset (90 classes)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32923238830886-42"><span class="crayon-c"># from disk</span></div><div class="crayon-line" id="crayon-5c05221c32923238830886-43"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] loading Mask R-CNN from disk..."</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32923238830886-44"><span class="crayon-v">net</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">dnn</span><span class="crayon-sy">.</span><span class="crayon-e">readNetFromTensorflow</span><span class="crayon-sy">(</span><span class="crayon-v">weightsPath</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">configPath</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0021 seconds] -->
<p>First, we build our weight and configuration paths (<strong>Lines 36-39</strong>), followed by loading the model via these paths (<strong>Line 44</strong>).</p>
<p>In the next block, we&#8217;ll load and pass an image through the Mask R-CNN neural net:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c32928246223567" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# load our input image and grab its spatial dimensions
image = cv2.imread(args["image"])
(H, W) = image.shape[:2]

# construct a blob from the input image and then perform a forward
# pass of the Mask R-CNN, giving us (1) the bounding box  coordinates
# of the objects in the image along with (2) the pixel-wise segmentation
# for each specific object
blob = cv2.dnn.blobFromImage(image, swapRB=True, crop=False)
net.setInput(blob)
start = time.time()
(boxes, masks) = net.forward(["detection_out_final", "detection_masks"])
end = time.time()

# show timing information and volume information on Mask R-CNN
print("[INFO] Mask R-CNN took {:.6f} seconds".format(end - start))
print("[INFO] boxes shape: {}".format(boxes.shape))
print("[INFO] masks shape: {}".format(masks.shape))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c32928246223567-46">46</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32928246223567-47">47</div><div class="crayon-num" data-line="crayon-5c05221c32928246223567-48">48</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32928246223567-49">49</div><div class="crayon-num" data-line="crayon-5c05221c32928246223567-50">50</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32928246223567-51">51</div><div class="crayon-num" data-line="crayon-5c05221c32928246223567-52">52</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32928246223567-53">53</div><div class="crayon-num" data-line="crayon-5c05221c32928246223567-54">54</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32928246223567-55">55</div><div class="crayon-num" data-line="crayon-5c05221c32928246223567-56">56</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32928246223567-57">57</div><div class="crayon-num" data-line="crayon-5c05221c32928246223567-58">58</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32928246223567-59">59</div><div class="crayon-num" data-line="crayon-5c05221c32928246223567-60">60</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32928246223567-61">61</div><div class="crayon-num" data-line="crayon-5c05221c32928246223567-62">62</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32928246223567-63">63</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c32928246223567-46"><span class="crayon-c"># load our input image and grab its spatial dimensions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32928246223567-47"><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imread</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"image"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c32928246223567-48"><span class="crayon-sy">(</span><span class="crayon-v">H</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">W</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32928246223567-49">&nbsp;</div><div class="crayon-line" id="crayon-5c05221c32928246223567-50"><span class="crayon-c"># construct a blob from the input image and then perform a forward</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32928246223567-51"><span class="crayon-c"># pass of the Mask R-CNN, giving us (1) the bounding box&nbsp;&nbsp;coordinates</span></div><div class="crayon-line" id="crayon-5c05221c32928246223567-52"><span class="crayon-c"># of the objects in the image along with (2) the pixel-wise segmentation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32928246223567-53"><span class="crayon-c"># for each specific object</span></div><div class="crayon-line" id="crayon-5c05221c32928246223567-54"><span class="crayon-v">blob</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">dnn</span><span class="crayon-sy">.</span><span class="crayon-e">blobFromImage</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">swapRB</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">crop</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32928246223567-55"><span class="crayon-v">net</span><span class="crayon-sy">.</span><span class="crayon-e">setInput</span><span class="crayon-sy">(</span><span class="crayon-v">blob</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c32928246223567-56"><span class="crayon-v">start</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">time</span><span class="crayon-sy">.</span><span class="crayon-k ">time</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32928246223567-57"><span class="crayon-sy">(</span><span class="crayon-v">boxes</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">masks</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">net</span><span class="crayon-sy">.</span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">"detection_out_final"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"detection_masks"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c32928246223567-58"><span class="crayon-v">end</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">time</span><span class="crayon-sy">.</span><span class="crayon-k ">time</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32928246223567-59">&nbsp;</div><div class="crayon-line" id="crayon-5c05221c32928246223567-60"><span class="crayon-c"># show timing information and volume information on Mask R-CNN</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32928246223567-61"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] Mask R-CNN took {:.6f} seconds"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">end</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">start</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c32928246223567-62"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] boxes shape: {}"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">boxes</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32928246223567-63"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] masks shape: {}"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">masks</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0045 seconds] -->
<p>Here we:</p>
<ul>
<li>Load the input 
			<span id="crayon-5c05221c3292d068920360" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">image</span></span></span>  and extract dimensions for scaling purposes later (<strong>Lines 47 and 48</strong>).</li>
<li>Construct a 
			<span id="crayon-5c05221c32932113167290" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">blob</span></span></span>  via 
			<span id="crayon-5c05221c32936369023559" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">dnn</span><span class="crayon-sy">.</span><span class="crayon-v">blobFromImage</span></span></span>  (<strong>Line 54</strong>). You can learn why and how to use this function in my <a href="https://www.pyimagesearch.com/2017/11/06/deep-learning-opencvs-blobfromimage-works/" target="blank" rel="noopener">previous tutorial</a>.</li>
<li>Perform a forward pass of the 
			<span id="crayon-5c05221c3293a690607571" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">blob</span></span></span>  through the 
			<span id="crayon-5c05221c3293e194421768" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">net</span></span></span>  while collecting timestamps (<strong>Lines 55-58</strong>). The results are contained in two important variables: 
			<span id="crayon-5c05221c32942887474081" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">boxes</span></span></span>  and 
			<span id="crayon-5c05221c32946749844877" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">masks</span></span></span> .</li>
</ul>
<p>Now that we&#8217;ve performed a forward pass of the Mask R-CNN on the image, we&#8217;ll want to filter + visualize our results. That&#8217;s exactly what this next for loop accomplishes. It is quite long, so I&#8217;ve broken it into <em>five code blocks</em> beginning here:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c3294b726713140" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# loop over the number of detected objects
for i in range(0, boxes.shape[2]):
	# extract the class ID of the detection along with the confidence
	# (i.e., probability) associated with the prediction
	classID = int(boxes[0, 0, i, 1])
	confidence = boxes[0, 0, i, 2]

	# filter out weak predictions by ensuring the detected probability
	# is greater than the minimum probability
	if confidence &gt; args["confidence"]:
		# clone our original image so we can draw on it
		clone = image.copy()

		# scale the bounding box coordinates back relative to the
		# size of the image and then compute the width and the height
		# of the bounding box
		box = boxes[0, 0, i, 3:7] * np.array([W, H, W, H])
		(startX, startY, endX, endY) = box.astype("int")
		boxW = endX - startX
		boxH = endY - startY</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c3294b726713140-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c3294b726713140-66">66</div><div class="crayon-num" data-line="crayon-5c05221c3294b726713140-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c3294b726713140-68">68</div><div class="crayon-num" data-line="crayon-5c05221c3294b726713140-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c3294b726713140-70">70</div><div class="crayon-num" data-line="crayon-5c05221c3294b726713140-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c3294b726713140-72">72</div><div class="crayon-num" data-line="crayon-5c05221c3294b726713140-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c3294b726713140-74">74</div><div class="crayon-num" data-line="crayon-5c05221c3294b726713140-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c3294b726713140-76">76</div><div class="crayon-num" data-line="crayon-5c05221c3294b726713140-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c3294b726713140-78">78</div><div class="crayon-num" data-line="crayon-5c05221c3294b726713140-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c3294b726713140-80">80</div><div class="crayon-num" data-line="crayon-5c05221c3294b726713140-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c3294b726713140-82">82</div><div class="crayon-num" data-line="crayon-5c05221c3294b726713140-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c3294b726713140-84">84</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c3294b726713140-65"><span class="crayon-c"># loop over the number of detected objects</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c3294b726713140-66"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">boxes</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c05221c3294b726713140-67"><span class="crayon-h">	</span><span class="crayon-c"># extract the class ID of the detection along with the confidence</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c3294b726713140-68"><span class="crayon-h">	</span><span class="crayon-c"># (i.e., probability) associated with the prediction</span></div><div class="crayon-line" id="crayon-5c05221c3294b726713140-69"><span class="crayon-h">	</span><span class="crayon-v">classID</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">int</span><span class="crayon-sy">(</span><span class="crayon-v">boxes</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c3294b726713140-70"><span class="crayon-h">	</span><span class="crayon-v">confidence</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">boxes</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c05221c3294b726713140-71">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c3294b726713140-72"><span class="crayon-h">	</span><span class="crayon-c"># filter out weak predictions by ensuring the detected probability</span></div><div class="crayon-line" id="crayon-5c05221c3294b726713140-73"><span class="crayon-h">	</span><span class="crayon-c"># is greater than the minimum probability</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c3294b726713140-74"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">confidence</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"confidence"</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c05221c3294b726713140-75"><span class="crayon-h">		</span><span class="crayon-c"># clone our original image so we can draw on it</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c3294b726713140-76"><span class="crayon-h">		</span><span class="crayon-v">clone</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c3294b726713140-77">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c3294b726713140-78"><span class="crayon-h">		</span><span class="crayon-c"># scale the bounding box coordinates back relative to the</span></div><div class="crayon-line" id="crayon-5c05221c3294b726713140-79"><span class="crayon-h">		</span><span class="crayon-c"># size of the image and then compute the width and the height</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c3294b726713140-80"><span class="crayon-h">		</span><span class="crayon-c"># of the bounding box</span></div><div class="crayon-line" id="crayon-5c05221c3294b726713140-81"><span class="crayon-h">		</span><span class="crayon-v">box</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">boxes</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-o">:</span><span class="crayon-cn">7</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-k ">W</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">H</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">W</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">H</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c3294b726713140-82"><span class="crayon-h">		</span><span class="crayon-sy">(</span><span class="crayon-v">startX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">startY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">endX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">endY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">box</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">"int"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c3294b726713140-83"><span class="crayon-h">		</span><span class="crayon-v">boxW</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">endX</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">startX</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c3294b726713140-84"><span class="crayon-e">		</span><span class="crayon-v">boxH</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">endY</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">startY</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0047 seconds] -->
<p>In this block, we begin our filter/visualization loop (<strong>Line 66</strong>).</p>
<p>We proceed to extract the 
			<span id="crayon-5c05221c32950081251510" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">classID</span></span></span>  and 
			<span id="crayon-5c05221c32954598569309" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">confidence</span></span></span>  of a particular detected object (<strong>Lines 69 and 70</strong>).</p>
<p>From there we filter out weak predictions by comparing the 
			<span id="crayon-5c05221c32958553451283" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">confidence</span></span></span>  to the command line argument 
			<span id="crayon-5c05221c3295d992987230" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">confidence</span></span></span>  value, ensuring we exceed it (<strong>Line 74</strong>).</p>
<p>Assuming that&#8217;s the case, we&#8217;ll go ahead and make a 
			<span id="crayon-5c05221c32961970173287" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">clone</span></span></span>  of the image (<strong>Line 76</strong>). We&#8217;ll need this image later.</p>
<p>Then we scale our object&#8217;s bounding box as well as calculate the box dimensions (<strong>Lines 81-84</strong>).</p>
<p>Image segmentation requires that we find all pixels where an object is present. Thus, we&#8217;re going to place a transparent overlay on top of the object to see how well our algorithm is performing. In order to do so, we&#8217;ll calculate a mask:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c32965748216120" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
		# extract the pixel-wise segmentation for the object, resize
		# the mask such that it's the same dimensions of the bounding
		# box, and then finally threshold to create a *binary* mask
		mask = masks[i, classID]
		mask = cv2.resize(mask, (boxW, boxH),
			interpolation=cv2.INTER_NEAREST)
		mask = (mask &gt; args["threshold"])

		# extract the ROI of the image
		roi = clone[startY:endY, startX:endX]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c32965748216120-86">86</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32965748216120-87">87</div><div class="crayon-num" data-line="crayon-5c05221c32965748216120-88">88</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32965748216120-89">89</div><div class="crayon-num" data-line="crayon-5c05221c32965748216120-90">90</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32965748216120-91">91</div><div class="crayon-num" data-line="crayon-5c05221c32965748216120-92">92</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32965748216120-93">93</div><div class="crayon-num" data-line="crayon-5c05221c32965748216120-94">94</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32965748216120-95">95</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c32965748216120-86"><span class="crayon-h">		</span><span class="crayon-c"># extract the pixel-wise segmentation for the object, resize</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32965748216120-87"><span class="crayon-h">		</span><span class="crayon-c"># the mask such that it's the same dimensions of the bounding</span></div><div class="crayon-line" id="crayon-5c05221c32965748216120-88"><span class="crayon-h">		</span><span class="crayon-c"># box, and then finally threshold to create a *binary* mask</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32965748216120-89"><span class="crayon-h">		</span><span class="crayon-v">mask</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">masks</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">classID</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c05221c32965748216120-90"><span class="crayon-h">		</span><span class="crayon-v">mask</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">resize</span><span class="crayon-sy">(</span><span class="crayon-v">mask</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">boxW</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">boxH</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32965748216120-91"><span class="crayon-h">			</span><span class="crayon-v">interpolation</span><span class="crayon-o">=</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">INTER_NEAREST</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c32965748216120-92"><span class="crayon-h">		</span><span class="crayon-v">mask</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mask</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"threshold"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32965748216120-93">&nbsp;</div><div class="crayon-line" id="crayon-5c05221c32965748216120-94"><span class="crayon-h">		</span><span class="crayon-c"># extract the ROI of the image</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32965748216120-95"><span class="crayon-h">		</span><span class="crayon-v">roi</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">clone</span><span class="crayon-sy">[</span><span class="crayon-v">startY</span><span class="crayon-o">:</span><span class="crayon-v">endY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">startX</span><span class="crayon-o">:</span><span class="crayon-v">endX</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0023 seconds] -->
<p>On <strong>Lines 89-91</strong>, we extract the pixel-wise segmentation for the object as well as resize it to the original image dimensions. Finally we threshold the 
			<span id="crayon-5c05221c3296a339303472" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">mask</span></span></span>  so that it is a binary array/image (<strong>Line 92</strong>).</p>
<p>We also extract the region of interest where the object resides (<strong>Line 95</strong>).</p>
<p>Both the 
			<span id="crayon-5c05221c3296e846242033" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">mask</span></span></span>  and 
			<span id="crayon-5c05221c32972216343518" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">roi</span></span></span>  can be seen visually in <strong>Figure 8</strong> later in the post.</p>
<p>For convenience, this next block accomplishes visualizing the 
			<span id="crayon-5c05221c32977011181046" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">mask</span></span></span> , 
			<span id="crayon-5c05221c3297b965717779" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">roi</span></span></span> , and segmented 
			<span id="crayon-5c05221c3297f454723412" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">instance</span></span></span>  if the 
			<span id="crayon-5c05221c32983202632409" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">visualize</span></span></span>  flag is set via command line arguments:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c32987939350583" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
		# check to see if are going to visualize how to extract the
		# masked region itself
		if args["visualize"] &gt; 0:
			# convert the mask from a boolean to an integer mask with
			# to values: 0 or 255, then apply the mask
			visMask = (mask * 255).astype("uint8")
			instance = cv2.bitwise_and(roi, roi, mask=visMask)

			# show the extracted ROI, the mask, along with the
			# segmented instance
			cv2.imshow("ROI", roi)
			cv2.imshow("Mask", visMask)
			cv2.imshow("Segmented", instance)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c32987939350583-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32987939350583-98">98</div><div class="crayon-num" data-line="crayon-5c05221c32987939350583-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32987939350583-100">100</div><div class="crayon-num" data-line="crayon-5c05221c32987939350583-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32987939350583-102">102</div><div class="crayon-num" data-line="crayon-5c05221c32987939350583-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32987939350583-104">104</div><div class="crayon-num" data-line="crayon-5c05221c32987939350583-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32987939350583-106">106</div><div class="crayon-num" data-line="crayon-5c05221c32987939350583-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32987939350583-108">108</div><div class="crayon-num" data-line="crayon-5c05221c32987939350583-109">109</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c32987939350583-97"><span class="crayon-h">		</span><span class="crayon-c"># check to see if are going to visualize how to extract the</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32987939350583-98"><span class="crayon-h">		</span><span class="crayon-c"># masked region itself</span></div><div class="crayon-line" id="crayon-5c05221c32987939350583-99"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"visualize"</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32987939350583-100"><span class="crayon-h">			</span><span class="crayon-c"># convert the mask from a boolean to an integer mask with</span></div><div class="crayon-line" id="crayon-5c05221c32987939350583-101"><span class="crayon-h">			</span><span class="crayon-c"># to values: 0 or 255, then apply the mask</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32987939350583-102"><span class="crayon-h">			</span><span class="crayon-v">visMask</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mask</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">"uint8"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c32987939350583-103"><span class="crayon-h">			</span><span class="crayon-v">instance</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">bitwise_and</span><span class="crayon-sy">(</span><span class="crayon-v">roi</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">roi</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mask</span><span class="crayon-o">=</span><span class="crayon-v">visMask</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32987939350583-104">&nbsp;</div><div class="crayon-line" id="crayon-5c05221c32987939350583-105"><span class="crayon-h">			</span><span class="crayon-c"># show the extracted ROI, the mask, along with the</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32987939350583-106"><span class="crayon-h">			</span><span class="crayon-c"># segmented instance</span></div><div class="crayon-line" id="crayon-5c05221c32987939350583-107"><span class="crayon-h">			</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-s">"ROI"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">roi</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32987939350583-108"><span class="crayon-h">			</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-s">"Mask"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">visMask</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c32987939350583-109"><span class="crayon-h">			</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-s">"Segmented"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">instance</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0028 seconds] -->
<p>In this block we:</p>
<ul>
<li>Check to see if we should visualize the ROI, mask, and segmented instance (<strong>Line 99</strong>).</li>
<li>Convert our mask from boolean to integer where a value of <em>&#8220;0&#8221;</em> indicates background and <em>&#8220;255&#8221;</em> foreground (<strong>Line 102</strong>).</li>
<li>Perform bitwise masking to visualize just the instance itself (<strong>Line 103</strong>).</li>
<li>Show all three images (<strong>Lines 107-109</strong>).</li>
</ul>
<p>Again, these visualization images will only be shown if the 
			<span id="crayon-5c05221c3298c551849633" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">visualize</span></span></span>  flag is set via the optional <a href="https://www.pyimagesearch.com/2018/03/12/python-argparse-command-line-arguments/">command line argument</a> (by default these images won&#8217;t be shown).</p>
<p>Now let&#8217;s continue on with visualization:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c32990158915352" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
		# now, extract *only* the masked region of the ROI by passing
		# in the boolean mask array as our slice condition
		roi = roi[mask]

		# randomly select a color that will be used to visualize this
		# particular instance segmentation then create a transparent
		# overlay by blending the randomly selected color with the ROI
		color = random.choice(COLORS)
		blended = ((0.4 * color) + (0.6 * roi)).astype("uint8")

		# store the blended ROI in the original image
		clone[startY:endY, startX:endX][mask] = blended</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c32990158915352-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32990158915352-112">112</div><div class="crayon-num" data-line="crayon-5c05221c32990158915352-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32990158915352-114">114</div><div class="crayon-num" data-line="crayon-5c05221c32990158915352-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32990158915352-116">116</div><div class="crayon-num" data-line="crayon-5c05221c32990158915352-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32990158915352-118">118</div><div class="crayon-num" data-line="crayon-5c05221c32990158915352-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32990158915352-120">120</div><div class="crayon-num" data-line="crayon-5c05221c32990158915352-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32990158915352-122">122</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c32990158915352-111"><span class="crayon-h">		</span><span class="crayon-c"># now, extract *only* the masked region of the ROI by passing</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32990158915352-112"><span class="crayon-h">		</span><span class="crayon-c"># in the boolean mask array as our slice condition</span></div><div class="crayon-line" id="crayon-5c05221c32990158915352-113"><span class="crayon-h">		</span><span class="crayon-v">roi</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">roi</span><span class="crayon-sy">[</span><span class="crayon-v">mask</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32990158915352-114">&nbsp;</div><div class="crayon-line" id="crayon-5c05221c32990158915352-115"><span class="crayon-h">		</span><span class="crayon-c"># randomly select a color that will be used to visualize this</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32990158915352-116"><span class="crayon-h">		</span><span class="crayon-c"># particular instance segmentation then create a transparent</span></div><div class="crayon-line" id="crayon-5c05221c32990158915352-117"><span class="crayon-h">		</span><span class="crayon-c"># overlay by blending the randomly selected color with the ROI</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32990158915352-118"><span class="crayon-h">		</span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">choice</span><span class="crayon-sy">(</span><span class="crayon-v">COLORS</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c32990158915352-119"><span class="crayon-h">		</span><span class="crayon-v">blended</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">0.4</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0.6</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">roi</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">"uint8"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32990158915352-120">&nbsp;</div><div class="crayon-line" id="crayon-5c05221c32990158915352-121"><span class="crayon-h">		</span><span class="crayon-c"># store the blended ROI in the original image</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32990158915352-122"><span class="crayon-h">		</span><span class="crayon-v">clone</span><span class="crayon-sy">[</span><span class="crayon-v">startY</span><span class="crayon-o">:</span><span class="crayon-v">endY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">startX</span><span class="crayon-o">:</span><span class="crayon-v">endX</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">mask</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">blended</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0025 seconds] -->
<p><strong>Line 113</strong> extracts <em>only</em> the masked region of the ROI by passing the boolean mask array as our slice condition.</p>
<p>Then we&#8217;ll randomly select one of our six 
			<span id="crayon-5c05221c32995766528502" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">COLORS</span></span></span>  to apply our transparent overlay on the object (<strong>Line 118</strong>).</p>
<p>Subsequently, we&#8217;ll blend our masked region with the 
			<span id="crayon-5c05221c32999546277784" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">roi</span></span></span>  (<strong>Line 119</strong>) followed by placing this 
			<span id="crayon-5c05221c3299d370618450" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">blended</span></span></span>  region into the 
			<span id="crayon-5c05221c329a1733335578" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">clone</span></span></span>  image (<strong>Line 122</strong>).</p>
<p>Finally, we&#8217;ll draw the rectangle and textual class label + confidence value on the image as well as display the result!</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c329a5518456757" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
		# draw the bounding box of the instance on the image
		color = [int(c) for c in color]
		cv2.rectangle(clone, (startX, startY), (endX, endY), color, 2)

		# draw the predicted label and associated probability of the
		# instance segmentation on the image
		text = "{}: {:.4f}".format(LABELS[classID], confidence)
		cv2.putText(clone, text, (startX, startY - 5),
			cv2.FONT_HERSHEY_SIMPLEX, 0.5, color, 2)

		# show the output image
		cv2.imshow("Output", clone)
		cv2.waitKey(0)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c329a5518456757-124">124</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329a5518456757-125">125</div><div class="crayon-num" data-line="crayon-5c05221c329a5518456757-126">126</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329a5518456757-127">127</div><div class="crayon-num" data-line="crayon-5c05221c329a5518456757-128">128</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329a5518456757-129">129</div><div class="crayon-num" data-line="crayon-5c05221c329a5518456757-130">130</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329a5518456757-131">131</div><div class="crayon-num" data-line="crayon-5c05221c329a5518456757-132">132</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329a5518456757-133">133</div><div class="crayon-num" data-line="crayon-5c05221c329a5518456757-134">134</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329a5518456757-135">135</div><div class="crayon-num" data-line="crayon-5c05221c329a5518456757-136">136</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c329a5518456757-124"><span class="crayon-h">		</span><span class="crayon-c"># draw the bounding box of the instance on the image</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329a5518456757-125"><span class="crayon-h">		</span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-k ">int</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c05221c329a5518456757-126"><span class="crayon-h">		</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">rectangle</span><span class="crayon-sy">(</span><span class="crayon-v">clone</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">startX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">startY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">endX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">endY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329a5518456757-127">&nbsp;</div><div class="crayon-line" id="crayon-5c05221c329a5518456757-128"><span class="crayon-h">		</span><span class="crayon-c"># draw the predicted label and associated probability of the</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329a5518456757-129"><span class="crayon-h">		</span><span class="crayon-c"># instance segmentation on the image</span></div><div class="crayon-line" id="crayon-5c05221c329a5518456757-130"><span class="crayon-h">		</span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"{}: {:.4f}"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">LABELS</span><span class="crayon-sy">[</span><span class="crayon-v">classID</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">confidence</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329a5518456757-131"><span class="crayon-h">		</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">putText</span><span class="crayon-sy">(</span><span class="crayon-v">clone</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">startX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">startY</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c05221c329a5518456757-132"><span class="crayon-h">			</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">FONT_HERSHEY_SIMPLEX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329a5518456757-133">&nbsp;</div><div class="crayon-line" id="crayon-5c05221c329a5518456757-134"><span class="crayon-h">		</span><span class="crayon-c"># show the output image</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329a5518456757-135"><span class="crayon-h">		</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-s">"Output"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">clone</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c329a5518456757-136"><span class="crayon-h">		</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">waitKey</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0036 seconds] -->
<p>To close out, we:</p>
<ul>
<li>Draw a colored bounding box around the object (<strong>Lines 125 and 126</strong>).</li>
<li>Build our class label + confidence 
			<span id="crayon-5c05221c329a9144283519" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">text</span></span></span>  as well as draw the 
			<span id="crayon-5c05221c329ae435977909" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">text</span></span></span>  above the bounding box (<strong>Lines 130-132</strong>).</li>
<li>Display the image until any key is pressed (<strong>Lines 135 and 136</strong>).</li>
</ul>
<p>Let’s give our Mask R-CNN code a try!</p>
<p>Make sure you’ve used the <em><strong>“Downloads”</strong></em> section of the tutorial to download the source code, trained Mask R-CNN, and example images. From there, open up your terminal and execute the following command:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c329b2063756050" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$ python mask_rcnn.py --mask-rcnn mask-rcnn-coco --image images/example_01.jpg
[INFO] loading Mask R-CNN from disk...
[INFO] Mask R-CNN took 0.761193 seconds
[INFO] boxes shape: (1, 1, 3, 7)
[INFO] masks shape: (100, 90, 15, 15)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c329b2063756050-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329b2063756050-2">2</div><div class="crayon-num" data-line="crayon-5c05221c329b2063756050-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329b2063756050-4">4</div><div class="crayon-num" data-line="crayon-5c05221c329b2063756050-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c329b2063756050-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">mask_rcnn</span><span class="crayon-e">.py</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-v">mask</span><span class="crayon-o">-</span><span class="crayon-e">rcnn </span><span class="crayon-v">mask</span><span class="crayon-o">-</span><span class="crayon-v">rcnn</span><span class="crayon-o">-</span><span class="crayon-v">coco</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">image </span><span class="crayon-v">images</span><span class="crayon-o">/</span><span class="crayon-v">example_01</span><span class="crayon-e">.jpg</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329b2063756050-2"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">loading </span><span class="crayon-i">Mask</span><span class="crayon-h"> </span><span class="crayon-v">R</span><span class="crayon-o">-</span><span class="crayon-e">CNN </span><span class="crayon-e">from </span><span class="crayon-v">disk</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5c05221c329b2063756050-3"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-i">Mask</span><span class="crayon-h"> </span><span class="crayon-v">R</span><span class="crayon-o">-</span><span class="crayon-e">CNN </span><span class="crayon-i">took</span><span class="crayon-h"> </span><span class="crayon-cn">0.761193</span><span class="crayon-h"> </span><span class="crayon-i">seconds</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329b2063756050-4"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">boxes </span><span class="crayon-v">shape</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c329b2063756050-5"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">masks </span><span class="crayon-v">shape</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0049 seconds] -->
<p><div style="max-width: 610px" class="wp-caption aligncenter"><img class="size-full" src="https://s3-us-west-2.amazonaws.com/static.pyimagesearch.com/opencv-mask-rcnn/mask_rcnn_example01.gif" width="600" height="450" /><p class="wp-caption-text"><strong>Figure 7:</strong> A Mask R-CNN applied to a scene of cars. Python and OpenCV were used to generate the masks.</p></div></p>
<p>In the above image, you can see that our Mask R-CNN has not only <em>localized</em> each of the cars in the image but has also <em>constructed a pixel-wise mask as well</em>, allowing us to segment each car from the image.</p>
<p>If we were to run the same command, this time supplying the 
			<span id="crayon-5c05221c329b7799840928" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">visualize</span></span></span>  flag, we can visualize the ROI, mask, and instance as well:</p>
<div id="attachment_9037" style="max-width: 610px" class="wp-caption aligncenter"><a href="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_roi_mask_segmented.jpg"><img class="size-full wp-image-9037" src="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_roi_mask_segmented.jpg" alt="" width="600" height="390" srcset="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_roi_mask_segmented.jpg 600w, https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_roi_mask_segmented-300x195.jpg 300w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><strong>Figure 8:</strong> Using the <code>--visualize</code> flag, we can view the ROI, mask, and segmentmentation intermediate steps for our Mask R-CNN pipeline built with Python and OpenCV.</p></div>
<p>Let’s try another example image:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c329bc055856990" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$ python mask_rcnn.py --mask-rcnn mask-rcnn-coco --image images/example_02.jpg \
	--confidence 0.6
[INFO] loading Mask R-CNN from disk...
[INFO] Mask R-CNN took 0.676008 seconds
[INFO] boxes shape: (1, 1, 8, 7)
[INFO] masks shape: (100, 90, 15, 15)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c329bc055856990-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329bc055856990-2">2</div><div class="crayon-num" data-line="crayon-5c05221c329bc055856990-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329bc055856990-4">4</div><div class="crayon-num" data-line="crayon-5c05221c329bc055856990-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329bc055856990-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c329bc055856990-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">mask_rcnn</span><span class="crayon-e">.py</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-v">mask</span><span class="crayon-o">-</span><span class="crayon-e">rcnn </span><span class="crayon-v">mask</span><span class="crayon-o">-</span><span class="crayon-v">rcnn</span><span class="crayon-o">-</span><span class="crayon-v">coco</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">image </span><span class="crayon-v">images</span><span class="crayon-o">/</span><span class="crayon-v">example_02</span><span class="crayon-e">.jpg</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329bc055856990-2"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-i">confidence</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span></div><div class="crayon-line" id="crayon-5c05221c329bc055856990-3"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">loading </span><span class="crayon-i">Mask</span><span class="crayon-h"> </span><span class="crayon-v">R</span><span class="crayon-o">-</span><span class="crayon-e">CNN </span><span class="crayon-e">from </span><span class="crayon-v">disk</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329bc055856990-4"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-i">Mask</span><span class="crayon-h"> </span><span class="crayon-v">R</span><span class="crayon-o">-</span><span class="crayon-e">CNN </span><span class="crayon-i">took</span><span class="crayon-h"> </span><span class="crayon-cn">0.676008</span><span class="crayon-h"> </span><span class="crayon-i">seconds</span></div><div class="crayon-line" id="crayon-5c05221c329bc055856990-5"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">boxes </span><span class="crayon-v">shape</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329bc055856990-6"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">masks </span><span class="crayon-v">shape</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0032 seconds] -->
<p><div style="max-width: 610px" class="wp-caption aligncenter"><img class="size-full" src="https://s3-us-west-2.amazonaws.com/static.pyimagesearch.com/opencv-mask-rcnn/mask_rcnn_example02.gif" width="600" height="450" /><p class="wp-caption-text"><strong>Figure 9:</strong> Using Python and OpenCV, we can perform instance segmentation using a Mask R-CNN.</p></div></p>
<p>Our Mask R-CNN has correctly detected and segmented both people, a dog, a horse, and a truck from the image.</p>
<p>Here’s one final example before we move on to using Mask R-CNNs in videos:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c329c1668332378" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$ python mask_rcnn.py --mask-rcnn mask-rcnn-coco --image images/example_03.jpg 
[INFO] loading Mask R-CNN from disk...
[INFO] Mask R-CNN took 0.680739 seconds
[INFO] boxes shape: (1, 1, 3, 7)
[INFO] masks shape: (100, 90, 15, 15)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c329c1668332378-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329c1668332378-2">2</div><div class="crayon-num" data-line="crayon-5c05221c329c1668332378-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329c1668332378-4">4</div><div class="crayon-num" data-line="crayon-5c05221c329c1668332378-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c329c1668332378-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">mask_rcnn</span><span class="crayon-e">.py</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-v">mask</span><span class="crayon-o">-</span><span class="crayon-e">rcnn </span><span class="crayon-v">mask</span><span class="crayon-o">-</span><span class="crayon-v">rcnn</span><span class="crayon-o">-</span><span class="crayon-v">coco</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">image </span><span class="crayon-v">images</span><span class="crayon-o">/</span><span class="crayon-v">example_03</span><span class="crayon-e">.jpg</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329c1668332378-2"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">loading </span><span class="crayon-i">Mask</span><span class="crayon-h"> </span><span class="crayon-v">R</span><span class="crayon-o">-</span><span class="crayon-e">CNN </span><span class="crayon-e">from </span><span class="crayon-v">disk</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5c05221c329c1668332378-3"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-i">Mask</span><span class="crayon-h"> </span><span class="crayon-v">R</span><span class="crayon-o">-</span><span class="crayon-e">CNN </span><span class="crayon-i">took</span><span class="crayon-h"> </span><span class="crayon-cn">0.680739</span><span class="crayon-h"> </span><span class="crayon-i">seconds</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329c1668332378-4"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">boxes </span><span class="crayon-v">shape</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c329c1668332378-5"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">masks </span><span class="crayon-v">shape</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">90</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0024 seconds] -->
<p><div style="max-width: 610px" class="wp-caption aligncenter"><img class="size-full" src="https://s3-us-west-2.amazonaws.com/static.pyimagesearch.com/opencv-mask-rcnn/mask_rcnn_example03.gif" width="600" height="530" /><p class="wp-caption-text"><strong>Figure 10:</strong> Here you can see me feeding a treat to the family beagle, Jemma. The pixel-wise map of each object identified is masked and transparently overlaid on the objects. This image was generated with OpenCV and Python using a pre-trained Mask R-CNN model.</p></div></p>
<p>In this image, you can see a photo of myself and Jemma, the family beagle.</p>
<p>Our Mask R-CNN is capable of detecting and localizing me, Jemma, and the chair with high confidence.</p>
<h3>OpenCV and Mask R-CNN in video streams</h3>
<p>Now that we’ve looked at how to apply Mask R-CNNs to images, let’s explore how they can be applied to videos as well.</p>
<p>Open up the 
			<span id="crayon-5c05221c329c7896461994" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">mask_rcnn_video</span><span class="crayon-e">.py</span></span></span>  file and insert the following code:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c329cb875854945" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# import the necessary packages
import numpy as np
import argparse
import imutils
import time
import cv2
import os

# construct the argument parse and parse the arguments
ap = argparse.ArgumentParser()
ap.add_argument("-i", "--input", required=True,
	help="path to input video file")
ap.add_argument("-o", "--output", required=True,
	help="path to output video file")
ap.add_argument("-m", "--mask-rcnn", required=True,
	help="base path to mask-rcnn directory")
ap.add_argument("-c", "--confidence", type=float, default=0.5,
	help="minimum probability to filter weak detections")
ap.add_argument("-t", "--threshold", type=float, default=0.3,
	help="minimum threshold for pixel-wise mask segmentation")
args = vars(ap.parse_args())</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c329cb875854945-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329cb875854945-2">2</div><div class="crayon-num" data-line="crayon-5c05221c329cb875854945-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329cb875854945-4">4</div><div class="crayon-num" data-line="crayon-5c05221c329cb875854945-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329cb875854945-6">6</div><div class="crayon-num" data-line="crayon-5c05221c329cb875854945-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329cb875854945-8">8</div><div class="crayon-num" data-line="crayon-5c05221c329cb875854945-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329cb875854945-10">10</div><div class="crayon-num" data-line="crayon-5c05221c329cb875854945-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329cb875854945-12">12</div><div class="crayon-num" data-line="crayon-5c05221c329cb875854945-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329cb875854945-14">14</div><div class="crayon-num" data-line="crayon-5c05221c329cb875854945-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329cb875854945-16">16</div><div class="crayon-num" data-line="crayon-5c05221c329cb875854945-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329cb875854945-18">18</div><div class="crayon-num" data-line="crayon-5c05221c329cb875854945-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329cb875854945-20">20</div><div class="crayon-num" data-line="crayon-5c05221c329cb875854945-21">21</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c329cb875854945-1"><span class="crayon-c"># import the necessary packages</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329cb875854945-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></div><div class="crayon-line" id="crayon-5c05221c329cb875854945-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329cb875854945-4"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">imutils</span></div><div class="crayon-line" id="crayon-5c05221c329cb875854945-5"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">time</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329cb875854945-6"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">cv2</span></div><div class="crayon-line" id="crayon-5c05221c329cb875854945-7"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">os</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329cb875854945-8">&nbsp;</div><div class="crayon-line" id="crayon-5c05221c329cb875854945-9"><span class="crayon-c"># construct the argument parse and parse the arguments</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329cb875854945-10"><span class="crayon-v">ap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span><span class="crayon-sy">.</span><span class="crayon-e">ArgumentParser</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c329cb875854945-11"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-i"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--input"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329cb875854945-12"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to input video file"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c329cb875854945-13"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-o"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--output"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329cb875854945-14"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to output video file"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c329cb875854945-15"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-m"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--mask-rcnn"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329cb875854945-16"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"base path to mask-rcnn directory"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c329cb875854945-17"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-c"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--confidence"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">type</span><span class="crayon-o">=</span><span class="crayon-k ">float</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">default</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329cb875854945-18"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"minimum probability to filter weak detections"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c329cb875854945-19"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-t"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--threshold"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">type</span><span class="crayon-o">=</span><span class="crayon-k ">float</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">default</span><span class="crayon-o">=</span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329cb875854945-20"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"minimum threshold for pixel-wise mask segmentation"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c329cb875854945-21"><span class="crayon-v">args</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">vars</span><span class="crayon-sy">(</span><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">parse_args</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0041 seconds] -->
<p>First we import our necessary packages and parse our command line arguments.</p>
<p>There are two new command line arguments (which replaces 
			<span id="crayon-5c05221c329d0352697498" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">image</span></span></span>  from the previous script):</p>
<ul>
<li>
			<span id="crayon-5c05221c329d4537956227" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-k ">input</span></span></span> : The path to our input video.</li>
<li>
			<span id="crayon-5c05221c329d8204389047" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">output</span></span></span> : The path to our output video (since we&#8217;ll be writing our results to disk in a video file).</li>
</ul>
<p>Now let&#8217;s load our class 
			<span id="crayon-5c05221c329dc756100201" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">LABELS</span></span></span> , 
			<span id="crayon-5c05221c329e0555701819" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">COLORS</span></span></span> , and Mask R-CNN neural 
			<span id="crayon-5c05221c329e4871826145" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">net</span></span></span> :</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c329e8520356264" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# load the COCO class labels our Mask R-CNN was trained on
labelsPath = os.path.sep.join([args["mask_rcnn"],
	"object_detection_classes_coco.txt"])
LABELS = open(labelsPath).read().strip().split("\n")

# initialize a list of colors to represent each possible class label
np.random.seed(42)
COLORS = np.random.randint(0, 255, size=(len(LABELS), 3),
	dtype="uint8")

# derive the paths to the Mask R-CNN weights and model configuration
weightsPath = os.path.sep.join([args["mask_rcnn"],
	"frozen_inference_graph.pb"])
configPath = os.path.sep.join([args["mask_rcnn"],
	"mask_rcnn_inception_v2_coco_2018_01_28.pbtxt"])

# load our Mask R-CNN trained on the COCO dataset (90 classes)
# from disk
print("[INFO] loading Mask R-CNN from disk...")
net = cv2.dnn.readNetFromTensorflow(weightsPath, configPath)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c329e8520356264-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329e8520356264-24">24</div><div class="crayon-num" data-line="crayon-5c05221c329e8520356264-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329e8520356264-26">26</div><div class="crayon-num" data-line="crayon-5c05221c329e8520356264-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329e8520356264-28">28</div><div class="crayon-num" data-line="crayon-5c05221c329e8520356264-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329e8520356264-30">30</div><div class="crayon-num" data-line="crayon-5c05221c329e8520356264-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329e8520356264-32">32</div><div class="crayon-num" data-line="crayon-5c05221c329e8520356264-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329e8520356264-34">34</div><div class="crayon-num" data-line="crayon-5c05221c329e8520356264-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329e8520356264-36">36</div><div class="crayon-num" data-line="crayon-5c05221c329e8520356264-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329e8520356264-38">38</div><div class="crayon-num" data-line="crayon-5c05221c329e8520356264-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329e8520356264-40">40</div><div class="crayon-num" data-line="crayon-5c05221c329e8520356264-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c329e8520356264-42">42</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c329e8520356264-23"><span class="crayon-c"># load the COCO class labels our Mask R-CNN was trained on</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329e8520356264-24"><span class="crayon-v">labelsPath</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-v">sep</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"mask_rcnn"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c05221c329e8520356264-25"><span class="crayon-h">	</span><span class="crayon-s">"object_detection_classes_coco.txt"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329e8520356264-26"><span class="crayon-v">LABELS</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-v">labelsPath</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">strip</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">"\n"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c329e8520356264-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329e8520356264-28"><span class="crayon-c"># initialize a list of colors to represent each possible class label</span></div><div class="crayon-line" id="crayon-5c05221c329e8520356264-29"><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">42</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329e8520356264-30"><span class="crayon-v">COLORS</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">randint</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">LABELS</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c05221c329e8520356264-31"><span class="crayon-h">	</span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-s">"uint8"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329e8520356264-32">&nbsp;</div><div class="crayon-line" id="crayon-5c05221c329e8520356264-33"><span class="crayon-c"># derive the paths to the Mask R-CNN weights and model configuration</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329e8520356264-34"><span class="crayon-v">weightsPath</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-v">sep</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"mask_rcnn"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c05221c329e8520356264-35"><span class="crayon-h">	</span><span class="crayon-s">"frozen_inference_graph.pb"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329e8520356264-36"><span class="crayon-v">configPath</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-v">sep</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"mask_rcnn"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c05221c329e8520356264-37"><span class="crayon-h">	</span><span class="crayon-s">"mask_rcnn_inception_v2_coco_2018_01_28.pbtxt"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329e8520356264-38">&nbsp;</div><div class="crayon-line" id="crayon-5c05221c329e8520356264-39"><span class="crayon-c"># load our Mask R-CNN trained on the COCO dataset (90 classes)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329e8520356264-40"><span class="crayon-c"># from disk</span></div><div class="crayon-line" id="crayon-5c05221c329e8520356264-41"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] loading Mask R-CNN from disk..."</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c329e8520356264-42"><span class="crayon-v">net</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">dnn</span><span class="crayon-sy">.</span><span class="crayon-e">readNetFromTensorflow</span><span class="crayon-sy">(</span><span class="crayon-v">weightsPath</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">configPath</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0047 seconds] -->
<p>Our 
			<span id="crayon-5c05221c329ed942098890" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">LABELS</span></span></span>  and 
			<span id="crayon-5c05221c329f2090079435" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">COLORS</span></span></span>  are loaded on <strong>Lines 24-31</strong>.</p>
<p>From there we define our 
			<span id="crayon-5c05221c329f6665839102" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">weightsPath</span></span></span>  and 
			<span id="crayon-5c05221c329fa688141971" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">configPath</span></span></span>  before loading our Mask R-CNN neural 
			<span id="crayon-5c05221c329fe153640024" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">net</span></span></span>  (<strong>Lines 34-42</strong>).</p>
<p>Now let&#8217;s initialize our video stream and video writer:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c32a02308126462" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# initialize the video stream and pointer to output video file
vs = cv2.VideoCapture(args["input"])
writer = None

# try to determine the total number of frames in the video file
try:
	prop = cv2.cv.CV_CAP_PROP_FRAME_COUNT if imutils.is_cv2() \
		else cv2.CAP_PROP_FRAME_COUNT
	total = int(vs.get(prop))
	print("[INFO] {} total frames in video".format(total))

# an error occurred while trying to determine the total
# number of frames in the video file
except:
	print("[INFO] could not determine # of frames in video")
	total = -1</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c32a02308126462-44">44</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a02308126462-45">45</div><div class="crayon-num" data-line="crayon-5c05221c32a02308126462-46">46</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a02308126462-47">47</div><div class="crayon-num" data-line="crayon-5c05221c32a02308126462-48">48</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a02308126462-49">49</div><div class="crayon-num" data-line="crayon-5c05221c32a02308126462-50">50</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a02308126462-51">51</div><div class="crayon-num" data-line="crayon-5c05221c32a02308126462-52">52</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a02308126462-53">53</div><div class="crayon-num" data-line="crayon-5c05221c32a02308126462-54">54</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a02308126462-55">55</div><div class="crayon-num" data-line="crayon-5c05221c32a02308126462-56">56</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a02308126462-57">57</div><div class="crayon-num" data-line="crayon-5c05221c32a02308126462-58">58</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a02308126462-59">59</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c32a02308126462-44"><span class="crayon-c"># initialize the video stream and pointer to output video file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a02308126462-45"><span class="crayon-v">vs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">VideoCapture</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"input"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c32a02308126462-46"><span class="crayon-v">writer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">None</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a02308126462-47">&nbsp;</div><div class="crayon-line" id="crayon-5c05221c32a02308126462-48"><span class="crayon-c"># try to determine the total number of frames in the video file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a02308126462-49"><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c05221c32a02308126462-50"><span class="crayon-h">	</span><span class="crayon-v">prop</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">cv</span><span class="crayon-sy">.</span><span class="crayon-e">CV_CAP_PROP_FRAME_COUNT </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">imutils</span><span class="crayon-sy">.</span><span class="crayon-e">is_cv2</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a02308126462-51"><span class="crayon-h">		</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">CAP_PROP_FRAME_COUNT</span></div><div class="crayon-line" id="crayon-5c05221c32a02308126462-52"><span class="crayon-e">	</span><span class="crayon-v">total</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">int</span><span class="crayon-sy">(</span><span class="crayon-v">vs</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-v">prop</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a02308126462-53"><span class="crayon-h">	</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] {} total frames in video"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">total</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c32a02308126462-54">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a02308126462-55"><span class="crayon-c"># an error occurred while trying to determine the total</span></div><div class="crayon-line" id="crayon-5c05221c32a02308126462-56"><span class="crayon-c"># number of frames in the video file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a02308126462-57"><span class="crayon-st">except</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c05221c32a02308126462-58"><span class="crayon-h">	</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] could not determine # of frames in video"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a02308126462-59"><span class="crayon-h">	</span><span class="crayon-v">total</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0031 seconds] -->
<p>Our video stream (
			<span id="crayon-5c05221c32a07058311241" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">vs</span></span></span> ) and video 
			<span id="crayon-5c05221c32a0b733754685" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">writer</span></span></span>  are initialized on <strong>Lines 45 and 46</strong>.</p>
<p>We attempt to determine the number of frames in the video file and display the 
			<span id="crayon-5c05221c32a0f280360855" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">total</span></span></span>  (<strong>Lines 49-53</strong>). If we&#8217;re unsuccessful, we&#8217;ll capture the exception and print a status message as well as set 
			<span id="crayon-5c05221c32a13570280028" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">total</span></span></span>  to 
			<span id="crayon-5c05221c32a17782451096" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">-</span><span class="crayon-cn">1</span></span></span>  (<strong>Lines 57-59</strong>). We&#8217;ll use this value to approximate how long it will take to process an entire video file.</p>
<p>Let&#8217;s begin our frame processing loop:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c32a1c431354395" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# loop over frames from the video file stream
while True:
	# read the next frame from the file
	(grabbed, frame) = vs.read()

	# if the frame was not grabbed, then we have reached the end
	# of the stream
	if not grabbed:
		break

	# construct a blob from the input frame and then perform a
	# forward pass of the Mask R-CNN, giving us (1) the bounding box
	# coordinates of the objects in the image along with (2) the
	# pixel-wise segmentation for each specific object
	blob = cv2.dnn.blobFromImage(frame, swapRB=True, crop=False)
	net.setInput(blob)
	start = time.time()
	(boxes, masks) = net.forward(["detection_out_final",
		"detection_masks"])
	end = time.time()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c32a1c431354395-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a1c431354395-62">62</div><div class="crayon-num" data-line="crayon-5c05221c32a1c431354395-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a1c431354395-64">64</div><div class="crayon-num" data-line="crayon-5c05221c32a1c431354395-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a1c431354395-66">66</div><div class="crayon-num" data-line="crayon-5c05221c32a1c431354395-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a1c431354395-68">68</div><div class="crayon-num" data-line="crayon-5c05221c32a1c431354395-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a1c431354395-70">70</div><div class="crayon-num" data-line="crayon-5c05221c32a1c431354395-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a1c431354395-72">72</div><div class="crayon-num" data-line="crayon-5c05221c32a1c431354395-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a1c431354395-74">74</div><div class="crayon-num" data-line="crayon-5c05221c32a1c431354395-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a1c431354395-76">76</div><div class="crayon-num" data-line="crayon-5c05221c32a1c431354395-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a1c431354395-78">78</div><div class="crayon-num" data-line="crayon-5c05221c32a1c431354395-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a1c431354395-80">80</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c32a1c431354395-61"><span class="crayon-c"># loop over frames from the video file stream</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a1c431354395-62"><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c05221c32a1c431354395-63"><span class="crayon-h">	</span><span class="crayon-c"># read the next frame from the file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a1c431354395-64"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">grabbed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">frame</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vs</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c32a1c431354395-65">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a1c431354395-66"><span class="crayon-h">	</span><span class="crayon-c"># if the frame was not grabbed, then we have reached the end</span></div><div class="crayon-line" id="crayon-5c05221c32a1c431354395-67"><span class="crayon-h">	</span><span class="crayon-c"># of the stream</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a1c431354395-68"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">grabbed</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c05221c32a1c431354395-69"><span class="crayon-h">		</span><span class="crayon-st">break</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a1c431354395-70">&nbsp;</div><div class="crayon-line" id="crayon-5c05221c32a1c431354395-71"><span class="crayon-h">	</span><span class="crayon-c"># construct a blob from the input frame and then perform a</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a1c431354395-72"><span class="crayon-h">	</span><span class="crayon-c"># forward pass of the Mask R-CNN, giving us (1) the bounding box</span></div><div class="crayon-line" id="crayon-5c05221c32a1c431354395-73"><span class="crayon-h">	</span><span class="crayon-c"># coordinates of the objects in the image along with (2) the</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a1c431354395-74"><span class="crayon-h">	</span><span class="crayon-c"># pixel-wise segmentation for each specific object</span></div><div class="crayon-line" id="crayon-5c05221c32a1c431354395-75"><span class="crayon-h">	</span><span class="crayon-v">blob</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">dnn</span><span class="crayon-sy">.</span><span class="crayon-e">blobFromImage</span><span class="crayon-sy">(</span><span class="crayon-v">frame</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">swapRB</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">crop</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a1c431354395-76"><span class="crayon-h">	</span><span class="crayon-v">net</span><span class="crayon-sy">.</span><span class="crayon-e">setInput</span><span class="crayon-sy">(</span><span class="crayon-v">blob</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c32a1c431354395-77"><span class="crayon-h">	</span><span class="crayon-v">start</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">time</span><span class="crayon-sy">.</span><span class="crayon-k ">time</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a1c431354395-78"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">boxes</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">masks</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">net</span><span class="crayon-sy">.</span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">"detection_out_final"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c05221c32a1c431354395-79"><span class="crayon-h">		</span><span class="crayon-s">"detection_masks"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a1c431354395-80"><span class="crayon-h">	</span><span class="crayon-v">end</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">time</span><span class="crayon-sy">.</span><span class="crayon-k ">time</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0032 seconds] -->
<p>We begin looping over frames by defining an infinite 
			<span id="crayon-5c05221c32a20230000498" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-st">while</span></span></span>  loop and capturing the first 
			<span id="crayon-5c05221c32a24109165659" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">frame</span></span></span>  (<strong>Lines 62-64</strong>). The loop will process the video until completion which is handled by the exit condition on <strong>Lines 68 and 69</strong>.</p>
<p>We then construct a 
			<span id="crayon-5c05221c32a28040086898" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">blob</span></span></span>  from the frame and pass it through the neural 
			<span id="crayon-5c05221c32a2c899481019" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">net</span></span></span>  while grabbing the elapsed time so we can calculate estimated time to completion later (<strong>Lines 75-80</strong>). The result is included in both 
			<span id="crayon-5c05221c32a31775407496" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">boxes</span></span></span>  and 
			<span id="crayon-5c05221c32a35823944599" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">masks</span></span></span> .</p>
<p>Now let&#8217;s begin looping over detected objects:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c32a39626966956" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
	# loop over the number of detected objects
	for i in range(0, boxes.shape[2]):
		# extract the class ID of the detection along with the
		# confidence (i.e., probability) associated with the
		# prediction
		classID = int(boxes[0, 0, i, 1])
		confidence = boxes[0, 0, i, 2]

		# filter out weak predictions by ensuring the detected
		# probability is greater than the minimum probability
		if confidence &gt; args["confidence"]:
			# scale the bounding box coordinates back relative to the
			# size of the frame and then compute the width and the
			# height of the bounding box
			(H, W) = frame.shape[:2]
			box = boxes[0, 0, i, 3:7] * np.array([W, H, W, H])
			(startX, startY, endX, endY) = box.astype("int")
			boxW = endX - startX
			boxH = endY - startY

			# extract the pixel-wise segmentation for the object,
			# resize the mask such that it's the same dimensions of
			# the bounding box, and then finally threshold to create
			# a *binary* mask
			mask = masks[i, classID]
			mask = cv2.resize(mask, (boxW, boxH),
				interpolation=cv2.INTER_NEAREST)
			mask = (mask &gt; args["threshold"])

			# extract the ROI of the image but *only* extracted the
			# masked region of the ROI
			roi = frame[startY:endY, startX:endX][mask]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c32a39626966956-82">82</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a39626966956-83">83</div><div class="crayon-num" data-line="crayon-5c05221c32a39626966956-84">84</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a39626966956-85">85</div><div class="crayon-num" data-line="crayon-5c05221c32a39626966956-86">86</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a39626966956-87">87</div><div class="crayon-num" data-line="crayon-5c05221c32a39626966956-88">88</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a39626966956-89">89</div><div class="crayon-num" data-line="crayon-5c05221c32a39626966956-90">90</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a39626966956-91">91</div><div class="crayon-num" data-line="crayon-5c05221c32a39626966956-92">92</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a39626966956-93">93</div><div class="crayon-num" data-line="crayon-5c05221c32a39626966956-94">94</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a39626966956-95">95</div><div class="crayon-num" data-line="crayon-5c05221c32a39626966956-96">96</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a39626966956-97">97</div><div class="crayon-num" data-line="crayon-5c05221c32a39626966956-98">98</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a39626966956-99">99</div><div class="crayon-num" data-line="crayon-5c05221c32a39626966956-100">100</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a39626966956-101">101</div><div class="crayon-num" data-line="crayon-5c05221c32a39626966956-102">102</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a39626966956-103">103</div><div class="crayon-num" data-line="crayon-5c05221c32a39626966956-104">104</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a39626966956-105">105</div><div class="crayon-num" data-line="crayon-5c05221c32a39626966956-106">106</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a39626966956-107">107</div><div class="crayon-num" data-line="crayon-5c05221c32a39626966956-108">108</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a39626966956-109">109</div><div class="crayon-num" data-line="crayon-5c05221c32a39626966956-110">110</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a39626966956-111">111</div><div class="crayon-num" data-line="crayon-5c05221c32a39626966956-112">112</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a39626966956-113">113</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c32a39626966956-82"><span class="crayon-h">	</span><span class="crayon-c"># loop over the number of detected objects</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a39626966956-83"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">boxes</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c05221c32a39626966956-84"><span class="crayon-h">		</span><span class="crayon-c"># extract the class ID of the detection along with the</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a39626966956-85"><span class="crayon-h">		</span><span class="crayon-c"># confidence (i.e., probability) associated with the</span></div><div class="crayon-line" id="crayon-5c05221c32a39626966956-86"><span class="crayon-h">		</span><span class="crayon-c"># prediction</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a39626966956-87"><span class="crayon-h">		</span><span class="crayon-v">classID</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">int</span><span class="crayon-sy">(</span><span class="crayon-v">boxes</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c32a39626966956-88"><span class="crayon-h">		</span><span class="crayon-v">confidence</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">boxes</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a39626966956-89">&nbsp;</div><div class="crayon-line" id="crayon-5c05221c32a39626966956-90"><span class="crayon-h">		</span><span class="crayon-c"># filter out weak predictions by ensuring the detected</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a39626966956-91"><span class="crayon-h">		</span><span class="crayon-c"># probability is greater than the minimum probability</span></div><div class="crayon-line" id="crayon-5c05221c32a39626966956-92"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">confidence</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"confidence"</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a39626966956-93"><span class="crayon-h">			</span><span class="crayon-c"># scale the bounding box coordinates back relative to the</span></div><div class="crayon-line" id="crayon-5c05221c32a39626966956-94"><span class="crayon-h">			</span><span class="crayon-c"># size of the frame and then compute the width and the</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a39626966956-95"><span class="crayon-h">			</span><span class="crayon-c"># height of the bounding box</span></div><div class="crayon-line" id="crayon-5c05221c32a39626966956-96"><span class="crayon-h">			</span><span class="crayon-sy">(</span><span class="crayon-v">H</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">W</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">frame</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a39626966956-97"><span class="crayon-h">			</span><span class="crayon-v">box</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">boxes</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-o">:</span><span class="crayon-cn">7</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-k ">W</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">H</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">W</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">H</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c32a39626966956-98"><span class="crayon-h">			</span><span class="crayon-sy">(</span><span class="crayon-v">startX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">startY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">endX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">endY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">box</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">"int"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a39626966956-99"><span class="crayon-h">			</span><span class="crayon-v">boxW</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">endX</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">startX</span></div><div class="crayon-line" id="crayon-5c05221c32a39626966956-100"><span class="crayon-e">			</span><span class="crayon-v">boxH</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">endY</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">startY</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a39626966956-101">&nbsp;</div><div class="crayon-line" id="crayon-5c05221c32a39626966956-102"><span class="crayon-h">			</span><span class="crayon-c"># extract the pixel-wise segmentation for the object,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a39626966956-103"><span class="crayon-h">			</span><span class="crayon-c"># resize the mask such that it's the same dimensions of</span></div><div class="crayon-line" id="crayon-5c05221c32a39626966956-104"><span class="crayon-h">			</span><span class="crayon-c"># the bounding box, and then finally threshold to create</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a39626966956-105"><span class="crayon-h">			</span><span class="crayon-c"># a *binary* mask</span></div><div class="crayon-line" id="crayon-5c05221c32a39626966956-106"><span class="crayon-h">			</span><span class="crayon-v">mask</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">masks</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">classID</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a39626966956-107"><span class="crayon-h">			</span><span class="crayon-v">mask</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">resize</span><span class="crayon-sy">(</span><span class="crayon-v">mask</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">boxW</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">boxH</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c05221c32a39626966956-108"><span class="crayon-h">				</span><span class="crayon-v">interpolation</span><span class="crayon-o">=</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">INTER_NEAREST</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a39626966956-109"><span class="crayon-h">			</span><span class="crayon-v">mask</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mask</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"threshold"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c32a39626966956-110">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a39626966956-111"><span class="crayon-h">			</span><span class="crayon-c"># extract the ROI of the image but *only* extracted the</span></div><div class="crayon-line" id="crayon-5c05221c32a39626966956-112"><span class="crayon-h">			</span><span class="crayon-c"># masked region of the ROI</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a39626966956-113"><span class="crayon-h">			</span><span class="crayon-v">roi</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">frame</span><span class="crayon-sy">[</span><span class="crayon-v">startY</span><span class="crayon-o">:</span><span class="crayon-v">endY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">startX</span><span class="crayon-o">:</span><span class="crayon-v">endX</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">mask</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0147 seconds] -->
<p>First we filter out weak detections with a low confidence value. Then we determine the bounding box coordinates and obtain the 
			<span id="crayon-5c05221c32a47194646170" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">mask</span></span></span>  and 
			<span id="crayon-5c05221c32a4c150603217" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">roi</span></span></span> .</p>
<p>Now let&#8217;s draw the object&#8217;s transparent overlay, bounding rectangle, and label + confidence:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c32a50895329345" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
			# grab the color used to visualize this particular class,
			# then create a transparent overlay by blending the color
			# with the ROI
			color = COLORS[classID]
			blended = ((0.4 * color) + (0.6 * roi)).astype("uint8")

			# store the blended ROI in the original frame
			frame[startY:endY, startX:endX][mask] = blended

			# draw the bounding box of the instance on the frame
			color = [int(c) for c in color]
			cv2.rectangle(frame, (startX, startY), (endX, endY),
				color, 2)

			# draw the predicted label and associated probability of
			# the instance segmentation on the frame
			text = "{}: {:.4f}".format(LABELS[classID], confidence)
			cv2.putText(frame, text, (startX, startY - 5),
				cv2.FONT_HERSHEY_SIMPLEX, 0.5, color, 2)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c32a50895329345-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a50895329345-116">116</div><div class="crayon-num" data-line="crayon-5c05221c32a50895329345-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a50895329345-118">118</div><div class="crayon-num" data-line="crayon-5c05221c32a50895329345-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a50895329345-120">120</div><div class="crayon-num" data-line="crayon-5c05221c32a50895329345-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a50895329345-122">122</div><div class="crayon-num" data-line="crayon-5c05221c32a50895329345-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a50895329345-124">124</div><div class="crayon-num" data-line="crayon-5c05221c32a50895329345-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a50895329345-126">126</div><div class="crayon-num" data-line="crayon-5c05221c32a50895329345-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a50895329345-128">128</div><div class="crayon-num" data-line="crayon-5c05221c32a50895329345-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a50895329345-130">130</div><div class="crayon-num" data-line="crayon-5c05221c32a50895329345-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a50895329345-132">132</div><div class="crayon-num" data-line="crayon-5c05221c32a50895329345-133">133</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c32a50895329345-115"><span class="crayon-h">			</span><span class="crayon-c"># grab the color used to visualize this particular class,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a50895329345-116"><span class="crayon-h">			</span><span class="crayon-c"># then create a transparent overlay by blending the color</span></div><div class="crayon-line" id="crayon-5c05221c32a50895329345-117"><span class="crayon-h">			</span><span class="crayon-c"># with the ROI</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a50895329345-118"><span class="crayon-h">			</span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">COLORS</span><span class="crayon-sy">[</span><span class="crayon-v">classID</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c05221c32a50895329345-119"><span class="crayon-h">			</span><span class="crayon-v">blended</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">0.4</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0.6</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">roi</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">"uint8"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a50895329345-120">&nbsp;</div><div class="crayon-line" id="crayon-5c05221c32a50895329345-121"><span class="crayon-h">			</span><span class="crayon-c"># store the blended ROI in the original frame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a50895329345-122"><span class="crayon-h">			</span><span class="crayon-v">frame</span><span class="crayon-sy">[</span><span class="crayon-v">startY</span><span class="crayon-o">:</span><span class="crayon-v">endY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">startX</span><span class="crayon-o">:</span><span class="crayon-v">endX</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">mask</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">blended</span></div><div class="crayon-line" id="crayon-5c05221c32a50895329345-123">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a50895329345-124"><span class="crayon-h">			</span><span class="crayon-c"># draw the bounding box of the instance on the frame</span></div><div class="crayon-line" id="crayon-5c05221c32a50895329345-125"><span class="crayon-h">			</span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-k ">int</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a50895329345-126"><span class="crayon-h">			</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">rectangle</span><span class="crayon-sy">(</span><span class="crayon-v">frame</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">startX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">startY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">endX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">endY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c05221c32a50895329345-127"><span class="crayon-h">				</span><span class="crayon-v">color</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a50895329345-128">&nbsp;</div><div class="crayon-line" id="crayon-5c05221c32a50895329345-129"><span class="crayon-h">			</span><span class="crayon-c"># draw the predicted label and associated probability of</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a50895329345-130"><span class="crayon-h">			</span><span class="crayon-c"># the instance segmentation on the frame</span></div><div class="crayon-line" id="crayon-5c05221c32a50895329345-131"><span class="crayon-h">			</span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"{}: {:.4f}"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">LABELS</span><span class="crayon-sy">[</span><span class="crayon-v">classID</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">confidence</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a50895329345-132"><span class="crayon-h">			</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">putText</span><span class="crayon-sy">(</span><span class="crayon-v">frame</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">startX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">startY</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c05221c32a50895329345-133"><span class="crayon-h">				</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">FONT_HERSHEY_SIMPLEX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0046 seconds] -->
<p>Here we&#8217;ve 
			<span id="crayon-5c05221c32a55724003396" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">blended</span></span></span>  our 
			<span id="crayon-5c05221c32a59048001029" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">roi</span></span></span>  with color and 
			<span id="crayon-5c05221c32a5e394066006" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">store</span></span></span>  it in the original 
			<span id="crayon-5c05221c32a62528154790" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">frame</span></span></span> , effectively creating a colored transparent overlay (<strong>Lines 118-122</strong>).</p>
<p>We then draw a 
			<span id="crayon-5c05221c32a66399085110" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">rectangle</span></span></span>  around the object and display the class label + 
			<span id="crayon-5c05221c32a6a060365432" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">confidence</span></span></span>  just above (<strong>Lines 125-133</strong>).</p>
<p>Finally, let&#8217;s write to the video file and clean up:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c32a6e847097516" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
	# check if the video writer is None
	if writer is None:
		# initialize our video writer
		fourcc = cv2.VideoWriter_fourcc(*"MJPG")
		writer = cv2.VideoWriter(args["output"], fourcc, 30,
			(frame.shape[1], frame.shape[0]), True)

		# some information on processing single frame
		if total &gt; 0:
			elap = (end - start)
			print("[INFO] single frame took {:.4f} seconds".format(elap))
			print("[INFO] estimated total time to finish: {:.4f}".format(
				elap * total))

	# write the output frame to disk
	writer.write(frame)

# release the file pointers
print("[INFO] cleaning up...")
writer.release()
vs.release()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c32a6e847097516-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a6e847097516-136">136</div><div class="crayon-num" data-line="crayon-5c05221c32a6e847097516-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a6e847097516-138">138</div><div class="crayon-num" data-line="crayon-5c05221c32a6e847097516-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a6e847097516-140">140</div><div class="crayon-num" data-line="crayon-5c05221c32a6e847097516-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a6e847097516-142">142</div><div class="crayon-num" data-line="crayon-5c05221c32a6e847097516-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a6e847097516-144">144</div><div class="crayon-num" data-line="crayon-5c05221c32a6e847097516-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a6e847097516-146">146</div><div class="crayon-num" data-line="crayon-5c05221c32a6e847097516-147">147</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a6e847097516-148">148</div><div class="crayon-num" data-line="crayon-5c05221c32a6e847097516-149">149</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a6e847097516-150">150</div><div class="crayon-num" data-line="crayon-5c05221c32a6e847097516-151">151</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a6e847097516-152">152</div><div class="crayon-num" data-line="crayon-5c05221c32a6e847097516-153">153</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a6e847097516-154">154</div><div class="crayon-num" data-line="crayon-5c05221c32a6e847097516-155">155</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c32a6e847097516-135"><span class="crayon-h">	</span><span class="crayon-c"># check if the video writer is None</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a6e847097516-136"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">writer </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-t">None</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c05221c32a6e847097516-137"><span class="crayon-h">		</span><span class="crayon-c"># initialize our video writer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a6e847097516-138"><span class="crayon-h">		</span><span class="crayon-v">fourcc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">VideoWriter_fourcc</span><span class="crayon-sy">(</span><span class="crayon-o">*</span><span class="crayon-s">"MJPG"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c32a6e847097516-139"><span class="crayon-h">		</span><span class="crayon-v">writer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">VideoWriter</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"output"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fourcc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a6e847097516-140"><span class="crayon-h">			</span><span class="crayon-sy">(</span><span class="crayon-v">frame</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">frame</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c32a6e847097516-141">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a6e847097516-142"><span class="crayon-h">		</span><span class="crayon-c"># some information on processing single frame</span></div><div class="crayon-line" id="crayon-5c05221c32a6e847097516-143"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">total</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a6e847097516-144"><span class="crayon-h">			</span><span class="crayon-v">elap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">end</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">start</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c32a6e847097516-145"><span class="crayon-h">			</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] single frame took {:.4f} seconds"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">elap</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a6e847097516-146"><span class="crayon-h">			</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] estimated total time to finish: {:.4f}"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-5c05221c32a6e847097516-147"><span class="crayon-h">				</span><span class="crayon-v">elap</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">total</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a6e847097516-148">&nbsp;</div><div class="crayon-line" id="crayon-5c05221c32a6e847097516-149"><span class="crayon-h">	</span><span class="crayon-c"># write the output frame to disk</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a6e847097516-150"><span class="crayon-h">	</span><span class="crayon-v">writer</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-v">frame</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c32a6e847097516-151">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a6e847097516-152"><span class="crayon-c"># release the file pointers</span></div><div class="crayon-line" id="crayon-5c05221c32a6e847097516-153"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] cleaning up..."</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a6e847097516-154"><span class="crayon-v">writer</span><span class="crayon-sy">.</span><span class="crayon-e">release</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c05221c32a6e847097516-155"><span class="crayon-v">vs</span><span class="crayon-sy">.</span><span class="crayon-e">release</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0037 seconds] -->
<p>On the first iteration of the loop, our video 
			<span id="crayon-5c05221c32a74259986924" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">writer</span></span></span>  is initialized.</p>
<p>An estimate of the amount of time that the processing will take is printed to the terminal on <strong>Lines 143-147</strong>.</p>
<p>The final operation of our loop is to 
			<span id="crayon-5c05221c32a78743431666" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">write</span></span></span>  the frame to disk via our 
			<span id="crayon-5c05221c32a7c742458596" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">writer</span></span></span>  object (<strong>Line 150</strong>).</p>
<p>You&#8217;ll notice that I&#8217;m not displaying each frame to the screen. The display operation is time-consuming and you&#8217;ll be able to view the output video with any media player when the script is finished processing anyways.</p>
<p><em><strong>Note:</strong> Furthermore, OpenCV does not support NVIDIA GPUs for it&#8217;s 
			<span id="crayon-5c05221c32a80507732395" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">dnn</span></span></span>  module. Right now only a limited number of GPUs are supported, mainly Intel GPUs. NVIDIA GPU support is coming soon but for the time being we cannot easily use a GPU with OpenCV&#8217;s 
			<span id="crayon-5c05221c32a85780387653" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">dnn</span></span></span>  module.</em></p>
<p>Lastly, we release video input and output file pointers (<strong>Lines 154 and 155</strong>).</p>
<p>Now that we’ve coded up our Mask R-CNN + OpenCV script for video streams, let’s give it a try!</p>
<p>Make sure you use the <em><strong>“Downloads”</strong></em> section of this tutorial to download the source code and Mask R-CNN model.</p>
<p>You&#8217;ll then need to collect your own videos with your smartphone or another recording device. Alternatively, you can download videos from YouTube as I have done.</p>
<p><em><strong>Note:</strong> I am <strong>intentionally</strong> not including the videos in today&#8217;s download because they are rather large (400MB+). If you choose to use the same videos as me, the credits and links are at the bottom of this section.</em></p>
<p>From there, open up a terminal and execute the following command:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c32a89681905144" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$ python mask_rcnn_video.py --input videos/cats_and_dogs.mp4 \
	--output output/cats_and_dogs_output.avi --mask-rcnn mask-rcnn-coco
[INFO] loading Mask R-CNN from disk...
[INFO] 19312 total frames in video
[INFO] single frame took 0.8585 seconds
[INFO] estimated total time to finish: 16579.2047</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c32a89681905144-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a89681905144-2">2</div><div class="crayon-num" data-line="crayon-5c05221c32a89681905144-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a89681905144-4">4</div><div class="crayon-num" data-line="crayon-5c05221c32a89681905144-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a89681905144-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c32a89681905144-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">mask_rcnn_video</span><span class="crayon-e">.py</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">input </span><span class="crayon-v">videos</span><span class="crayon-o">/</span><span class="crayon-v">cats_and_dogs</span><span class="crayon-e">.mp4</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a89681905144-2"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-e">output </span><span class="crayon-v">output</span><span class="crayon-o">/</span><span class="crayon-v">cats_and_dogs_output</span><span class="crayon-e">.avi</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-v">mask</span><span class="crayon-o">-</span><span class="crayon-e">rcnn </span><span class="crayon-v">mask</span><span class="crayon-o">-</span><span class="crayon-v">rcnn</span><span class="crayon-o">-</span><span class="crayon-i">coco</span></div><div class="crayon-line" id="crayon-5c05221c32a89681905144-3"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">loading </span><span class="crayon-i">Mask</span><span class="crayon-h"> </span><span class="crayon-v">R</span><span class="crayon-o">-</span><span class="crayon-e">CNN </span><span class="crayon-e">from </span><span class="crayon-v">disk</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a89681905144-4"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-cn">19312</span><span class="crayon-h"> </span><span class="crayon-e">total </span><span class="crayon-e">frames </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-i">video</span></div><div class="crayon-line" id="crayon-5c05221c32a89681905144-5"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">single </span><span class="crayon-e">frame </span><span class="crayon-i">took</span><span class="crayon-h"> </span><span class="crayon-cn">0.8585</span><span class="crayon-h"> </span><span class="crayon-i">seconds</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a89681905144-6"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">estimated </span><span class="crayon-e">total </span><span class="crayon-r">time</span><span class="crayon-h"> </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-v">finish</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">16579.2047</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0020 seconds] -->
<p><div style="max-width: 349px" class="wp-caption aligncenter"><img class="size-full" src="https://s3-us-west-2.amazonaws.com/static.pyimagesearch.com/opencv-mask-rcnn/mask_rcnn_dogs.gif" width="339" height="310" /><p class="wp-caption-text"><strong>Figure 11:</strong> Mask R-CNN applied to video with Python and OpenCV.</p></div></p>
<p><iframe width="500" height="375" src="https://www.youtube.com/embed/T_GXkW0BUyA?feature=oembed" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></p>
<p>In the above video, you can find funny video clips of dogs and cats with a Mask R-CNN applied to them!</p>
<p>Here is a second example, this one of applying OpenCV and a Mask R- CNN to video clips of cars “slipping and sliding” in wintry conditions:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c05221c32a8f076723282" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Mask R-CNN with OpenCV</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$ python mask_rcnn_video.py --input videos/slip_and_slide.mp4 \
	--output output/slip_and_slide_output.avi --mask-rcnn mask-rcnn-coco
[INFO] loading Mask R-CNN from disk...
[INFO] 17421 total frames in video
[INFO] single frame took 0.9341 seconds
[INFO] estimated total time to finish: 16272.9920</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c05221c32a8f076723282-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a8f076723282-2">2</div><div class="crayon-num" data-line="crayon-5c05221c32a8f076723282-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a8f076723282-4">4</div><div class="crayon-num" data-line="crayon-5c05221c32a8f076723282-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c05221c32a8f076723282-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c05221c32a8f076723282-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">mask_rcnn_video</span><span class="crayon-e">.py</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">input </span><span class="crayon-v">videos</span><span class="crayon-o">/</span><span class="crayon-v">slip_and_slide</span><span class="crayon-e">.mp4</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a8f076723282-2"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-e">output </span><span class="crayon-v">output</span><span class="crayon-o">/</span><span class="crayon-v">slip_and_slide_output</span><span class="crayon-e">.avi</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-v">mask</span><span class="crayon-o">-</span><span class="crayon-e">rcnn </span><span class="crayon-v">mask</span><span class="crayon-o">-</span><span class="crayon-v">rcnn</span><span class="crayon-o">-</span><span class="crayon-i">coco</span></div><div class="crayon-line" id="crayon-5c05221c32a8f076723282-3"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">loading </span><span class="crayon-i">Mask</span><span class="crayon-h"> </span><span class="crayon-v">R</span><span class="crayon-o">-</span><span class="crayon-e">CNN </span><span class="crayon-e">from </span><span class="crayon-v">disk</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a8f076723282-4"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-cn">17421</span><span class="crayon-h"> </span><span class="crayon-e">total </span><span class="crayon-e">frames </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-i">video</span></div><div class="crayon-line" id="crayon-5c05221c32a8f076723282-5"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">single </span><span class="crayon-e">frame </span><span class="crayon-i">took</span><span class="crayon-h"> </span><span class="crayon-cn">0.9341</span><span class="crayon-h"> </span><span class="crayon-i">seconds</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c05221c32a8f076723282-6"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">estimated </span><span class="crayon-e">total </span><span class="crayon-r">time</span><span class="crayon-h"> </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-v">finish</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">16272.9920</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0022 seconds] -->
<p><div style="max-width: 410px" class="wp-caption aligncenter"><img class="size-full" src="https://s3-us-west-2.amazonaws.com/static.pyimagesearch.com/opencv-mask-rcnn/mask_rcnn_cars.gif" width="400" height="224" /><p class="wp-caption-text"><strong>Figure 12:</strong> Mask R-CNN object detection is applied to a video scene of cars using Python and OpenCV.</p></div></p>
<p><iframe width="500" height="375" src="https://www.youtube.com/embed/8nbzVARfosE?feature=oembed" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></p>
<p>You can imagine a Mask R-CNN being applied to highly trafficked roads, checking for congestion, car accidents, or travelers in need of immediate help and attention.</p>
<p><strong>Credits for the videos and audio include:</strong></p>
<ul>
<li>Cats and Dogs
<ul>
<li><em>&#8220;Try Not To Laugh Challenge &#8211; Funny Cat &amp; Dog Vines compilation 2017&#8221;</em> on <a href="https://www.youtube.com/watch?v=EtH9Yllzjcc" target="blank" rel="noopener">YouTube</a></li>
<li><em>&#8220;Happy rock&#8221;</em> on <a href="https://www.bensound.com/royalty-free-music/track/happy-rock" target="blank" rel="noopener">BenSound</a></li>
</ul>
</li>
<li>Slip and Slide
<ul>
<li><em>&#8220;Compilation of Ridiculous Car Crash and Slip &amp; Slide Winter Weather &#8211; Part 1&#8221;</em> on <a href="https://www.youtube.com/watch?v=i59v0p-gAtk" target="blank" rel="noopener">YouTube</a></li>
<li><em>&#8220;Epic&#8221;</em> on <a href="https://www.bensound.com/royalty-free-music/track/epic" target="blank" rel="noopener">BenSound</a></li>
</ul>
</li>
</ul>
<h3>How do I train my own Mask R-CNN models?</h3>
<div id="attachment_9050" style="max-width: 560px" class="wp-caption aligncenter"><a href="https://www.pyimagesearch.com/deep-learning-computer-vision-python-book/"><img class="wp-image-9050" src="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_dl4cv.jpg" alt="" width="550" height="413" srcset="https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_dl4cv.jpg 600w, https://www.pyimagesearch.com/wp-content/uploads/2018/11/mask_rcnn_dl4cv-300x225.jpg 300w" sizes="(max-width: 550px) 100vw, 550px" /></a><p class="wp-caption-text"><strong>Figure 13:</strong> Inside my book, <a href="https://www.pyimagesearch.com/deep-learning-computer-vision-python-book/" target="_blank" rel="noopener"><em>Deep Learning for Computer Vision with Python</em></a>, you will learn how to annotate your own training data, train your custom Mask R-CNN, and apply it to your own images. I also provide two case studies on (1) skin lesion/cancer segmentation and (2) prescription pill segmentation, a first step in pill identification.</p></div>
<p>The Mask R-CNN model we used in this tutorial was <em>pre-trained</em> on the COCO dataset&#8230;</p>
<p><strong>&#8230;but what if you wanted to train a Mask R-CNN <em>on your own custom dataset?</em></strong></p>
<p>Inside my book, <a href="https://www.pyimagesearch.com/deep-learning-computer-vision-python-book/" target="_blank" rel="noopener"><em>Deep Learning for Computer Vision with Python</em></a>, I:</p>
<ol>
<li>Teach you how to train a Mask R-CNN to <strong>automatically detect and segment cancerous skin </strong><b>lesions</b> &#8212; a first step in building an automatic cancer risk factor classification system.</li>
<li>Provide you with my favorite image annotation tools, <strong>enabling you to create masks for your input images.</strong></li>
<li>Show you how to train a Mask R-CNN <strong>on your custom dataset.</strong></li>
<li>Provide you with my best <strong>practices, tips, and suggestions</strong> when training your own Mask R-CNN.</li>
</ol>
<p>All of the Mask R-CNN chapters included a detailed explanation of <em>both</em> the algorithm and code, <strong>ensuring you will be able to successfully train your own Mask R-CNNs.</strong></p>
<p style="text-align: center;"><a href="https://www.pyimagesearch.com/deep-learning-computer-vision-python-book/" target="blank" rel="noopener"><strong>To learn more about my book (and grab your <em>free</em> set of sample chapters and table of contents),</strong> <em><strong>just click here.</strong></em></a></p>
<h2>Summary</h2>
<p>In this tutorial, you learned how to apply the Mask R-CNN architecture with OpenCV and Python to segment objects from images and video streams.</p>
<p>Object detectors such as YOLO, SSDs, and Faster R-CNNs are only capable of producing bounding box coordinates of an object in an image &#8212; <strong>they tell us <em>nothing</em> about the actual shape of the object itself.</strong></p>
<p><strong>Using Mask R-CNN we can generate pixel-wise masks for each object in an image, thereby allowing us to <em>segment</em> the foreground object from the background.</strong></p>
<p>Furthermore, Mask R-CNNs enable us to segment complex objects and shapes from images which traditional computer vision algorithms would not enable us to do.</p>
<p>I hope you enjoyed today’s tutorial on OpenCV and Mask R-CNN!</p>
<p><strong>To download the source code to this post, and be notified when future tutorials are published here on PyImageSearch, <em>just enter your email address in the form below!</em></strong></p>
<h2 id="post_downloads">Downloads:</h2>
<div id="mc4wp-form-1" class="form mc4wp-form mc4wp-form-761"><form action="https://www.getdrip.com/forms/192164124/submissions" method="post" target="blank" data-drip-embedded-form="192164124"><img style="padding-right: 10px; width: 115px; border: none; float: left;" src="https://www.pyimagesearch.com/wp-content/uploads/2014/02/download-code-icon.png" alt="" />If you would like to download the code and images used in this post, please enter your email address in the form below. Not only will you get a .zip of the code, I’ll also send you a <strong>FREE 17-page Resource Guide on Computer Vision, OpenCV, and Deep Learning.</strong> Inside you'll find my hand-picked tutorials, books, courses, and libraries to help you master CV and DL! Sound good? If so, enter your email address and I’ll send you the code immediately!
<p style="margin-left: 130px; margin-top: 10px;"><label for="fields[email]">Email address:</label><input name="fields[email]" type="email" value="" placeholder="Your email address" /></p>
<p style="margin-left: 130px;"><input type="submit" value="Download the code!" /></p>
</form></div>
	</section><!-- /.entry -->
	<div class="fix"></div>
		<aside id="connect">
		<h3>Resource Guide (it’s totally free).</h3>

		<div >
			<p><img title="Get your FREE 17-page Computer Vision and Deep Learning Resource Guide PDF" src="https://www.pyimagesearch.com/wp-content/uploads/2018/08/computer_vision_deep_learning_resource_guide_cover.png" style="padding-right: 10px;width: 230px;float: left" />
<div style="padding-top: 35px">
Enter your email address below to get my <strong>free 17-page Computer Vision, OpenCV, and Deep Learning Resource Guide PDF</strong>. Inside you'll find my hand-picked tutorials, books, courses, and Python libraries to help you master computer vision and deep learning!</div></p>

			
						<form action="https://www.getdrip.com/forms/657075648/submissions" method="post" target="_blank" data-drip-embedded-form="657075648">
				<div>
					<input type="email" name="fields[email]" class="required email" value="" placeholder="Your email address" style="width: 50%;" />
				</div>
				<div>
					<input id="mc-embedded-subscribe" type="submit" name="submit" class="btn submit button" value="Download the Guide!" data-drip-attribute="sign-up-button" />
				</div>
			</form>
			
						<div class="social">
		   					</div>
			
		</div><!-- col-left -->

		
        <div class="fix"></div>
	</aside>
	<div class="post-utility"><p class="tags"><i class="icon-tag"></i> <a href="https://www.pyimagesearch.com/tag/deep-learning/" rel="tag">deep learning</a>, <a href="https://www.pyimagesearch.com/tag/instance-segmentation/" rel="tag">instance segmentation</a>, <a href="https://www.pyimagesearch.com/tag/mask-r-cnn/" rel="tag">mask r-cnn</a>, <a href="https://www.pyimagesearch.com/tag/masks/" rel="tag">masks</a>, <a href="https://www.pyimagesearch.com/tag/object-detection/" rel="tag">object detection</a>, <a href="https://www.pyimagesearch.com/tag/segmentation/" rel="tag">segmentation</a>, <a href="https://www.pyimagesearch.com/tag/semantic-segmentation/" rel="tag">semantic segmentation</a></p> </div>
</article><!-- /.post -->
	        <div class="post-entries">
	            <div class="nav-prev fl"><a href="https://www.pyimagesearch.com/2018/11/12/yolo-object-detection-with-opencv/" rel="prev"><i class="icon-angle-left"></i> YOLO object detection with OpenCV</a></div>
	            <div class="nav-next fr"><a href="https://www.pyimagesearch.com/2018/11/26/instance-segmentation-with-opencv/" rel="next">Instance segmentation with OpenCV <i class="icon-angle-right"></i></a></div>
	            <div class="fix"></div>
	        </div>

		<div id="comments">		 	<h3 id="comments-title">60 Responses to <em>Mask R-CNN with OpenCV</em></h3>
		 	<ol class="commentlist">
					                 
		<li class="comment even thread-even depth-1">
	    
	    	<a name="comment-487807"></a>
	      	
	      	<div id="li-comment-487807" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/f5e0acb55e891aaf8ca5ae42494cc3ad?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f5e0acb55e891aaf8ca5ae42494cc3ad?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Faizan Amin</span>           
	                <span class="date">November 19, 2018 at 10:39 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487807" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487807">
				
				<p>Hi. How can we train our own Mask RCNN model. Can we use Tensorflow Models API for this purpose?</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487807' onclick='return addComment.moveForm( "comment-487807", "487807", "respond", "8999" )' aria-label='Reply to Faizan Amin'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-2">
	    
	    	<a name="comment-487809"></a>
	      	
	      	<div id="li-comment-487809" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 19, 2018 at 10:46 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487809" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487809">
				
				<p>Hey Faizan &#8212; I cover how to train your own custom Mask R-CNN models inside <a target="blank" href="https://www.pyimagesearch.com/deep-learning-computer-vision-python-book/">Deep Learning for Computer Vision with Python.</a></p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487809' onclick='return addComment.moveForm( "comment-487809", "487809", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment even thread-odd thread-alt depth-1">
	    
	    	<a name="comment-487810"></a>
	      	
	      	<div id="li-comment-487810" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/030213908ca84904ccbef7984b719f8e?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/030213908ca84904ccbef7984b719f8e?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Steph</span>           
	                <span class="date">November 19, 2018 at 10:49 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487810" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487810">
				
				<p>Hi Adrian, </p>
<p>thanks a lot for another great tutorial.<br />
I already knew Mask-RCNN for trying it on my problem, but apparently that is not the way to go.<br />
What I want to do is to detect movie posters in videos and then track them over time. The first time they appear I also manually define a mask to simplify the process. Unfortunately any detection/tracking method I tried failed miserably&#8230; the detection step is hard, because the poster is not an object available in the models, and it can vary a lot depending on the movie it represents; tracking also fails, since I need a pixel perfect tracking and any deep learning method I tried does not return a shape with straight borders but always rounded objects.</p>
<p>Do you have any algorithms to recommend for this specific task? Or shall I resort to traditional, not DL-based methids?</p>
<p>Thanks in advance!</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487810' onclick='return addComment.moveForm( "comment-487810", "487810", "respond", "8999" )' aria-label='Reply to Steph'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-2">
	    
	    	<a name="comment-487819"></a>
	      	
	      	<div id="li-comment-487819" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 19, 2018 at 12:21 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487819" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487819">
				
				<p>How many example images per movie poster do you have?</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487819' onclick='return addComment.moveForm( "comment-487819", "487819", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment even depth-3">
	    
	    	<a name="comment-487987"></a>
	      	
	      	<div id="li-comment-487987" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/030213908ca84904ccbef7984b719f8e?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/030213908ca84904ccbef7984b719f8e?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Steph</span>           
	                <span class="date">November 20, 2018 at 3:49 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487987" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487987">
				
				<p>I have 10 videos, each of them showing a movie poster for about 150 frames. The camera is always panning or zooming, so the shape and size of the poster is constantly changing.<br />
Thanks in advance for any help 🙂</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487987' onclick='return addComment.moveForm( "comment-487987", "487987", "respond", "8999" )' aria-label='Reply to Steph'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-4">
	    
	    	<a name="comment-488044"></a>
	      	
	      	<div id="li-comment-488044" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 20, 2018 at 9:04 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488044" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488044">
				
				<p>I assume each of the 150 frames has the same movie poster? Are these 150 frames your training data? If so, have you labeled them and annotated them so you can train an object detector?</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488044' onclick='return addComment.moveForm( "comment-488044", "488044", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment even depth-5">
	    
	    	<a name="comment-488064"></a>
	      	
	      	<div id="li-comment-488064" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/030213908ca84904ccbef7984b719f8e?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/030213908ca84904ccbef7984b719f8e?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Steph</span>           
	                <span class="date">November 20, 2018 at 9:27 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488064" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488064">
				
				<p>Yes, I have 1500 images as training data. For each movie poster, i created a binary mask showing where is the poster. The shape is usually a quadrilateral, unless in case the poster is partially occluded.<br />
I&#8217;d like to train a system which, given an annotated frame of a video, could then detect the movie poster with pixel precision during camera movement and occlusions, but so far I didn&#8217;t have luck. Even system especially trained for that (as they do in the Davis challenge <a href="https://davischallenge.org/" rel="nofollow">https://davischallenge.org/</a>) seem to fail after just a few frames.<br />
If you are going to work / publish a post on the issue, let me know!</p>
		            
										
	                <div class="reply">
	                    	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-5">
	    
	    	<a name="comment-488281"></a>
	      	
	      	<div id="li-comment-488281" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 21, 2018 at 9:39 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488281" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488281">
				
				<p>Thanks for the clarification. In that case I would highly suggest using a Mask R-CNN. The Mask R-CNN will give you a pixel-wise segmentation of the movie poster. Once you have the location of the poster you can either:</p>
<p>1. Continue to process subsequent frames using the Mask R-CNN<br />
2. Or you can apply a dedicated <a target="blank" href="https://www.pyimagesearch.com/2018/07/30/opencv-object-tracking/">object tracker</a></p>
		            
										
	                <div class="reply">
	                    	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment even thread-even depth-1">
	    
	    	<a name="comment-487813"></a>
	      	
	      	<div id="li-comment-487813" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/5dbade51d7c9ef6a058a8e40a3c39e2f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5dbade51d7c9ef6a058a8e40a3c39e2f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Mansoor</span>           
	                <span class="date">November 19, 2018 at 11:38 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487813" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487813">
				
				<p>Adrian, you are constantly bombarding us with such valuable information every single week, which otherwise would take us months to even understand.</p>
<p>Thank you for sharing this incredible piece of code with us.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487813' onclick='return addComment.moveForm( "comment-487813", "487813", "respond", "8999" )' aria-label='Reply to Mansoor'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-2">
	    
	    	<a name="comment-487818"></a>
	      	
	      	<div id="li-comment-487818" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 19, 2018 at 12:20 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487818" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487818">
				
				<p>Thanks Mansoor &#8212; it is my pleasure 🙂</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487818' onclick='return addComment.moveForm( "comment-487818", "487818", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment even thread-odd thread-alt depth-1">
	    
	    	<a name="comment-487816"></a>
	      	
	      	<div id="li-comment-487816" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/3d520f5769fe809649bf62e018e5820d?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3d520f5769fe809649bf62e018e5820d?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name"><a href='https://humanbehaviors.ai' rel='external nofollow' class='url'>YEVHENII RVACHOV</a></span>           
	                <span class="date">November 19, 2018 at 12:04 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487816" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487816">
				
				<p>Hello, Adrian.</p>
<p>Thanks so much for your article and explanation of principles R-CNN</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487816' onclick='return addComment.moveForm( "comment-487816", "487816", "respond", "8999" )' aria-label='Reply to YEVHENII RVACHOV'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-2">
	    
	    	<a name="comment-487817"></a>
	      	
	      	<div id="li-comment-487817" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 19, 2018 at 12:20 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487817" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487817">
				
				<p>You are welcome, I&#8217;m happy you found the post useful! I hope you can apply it to your own projects.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487817' onclick='return addComment.moveForm( "comment-487817", "487817", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment even thread-even depth-1">
	    
	    	<a name="comment-487831"></a>
	      	
	      	<div id="li-comment-487831" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d5648f607ea2c2e9172f2fbdd25e0edf?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d5648f607ea2c2e9172f2fbdd25e0edf?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name"><a href='http://www.facebook.com/herambmakerlab' rel='external nofollow' class='url'>Atul</a></span>           
	                <span class="date">November 19, 2018 at 12:31 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487831" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487831">
				
				<p>Thanks , very informative and useful 🙂</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487831' onclick='return addComment.moveForm( "comment-487831", "487831", "respond", "8999" )' aria-label='Reply to Atul'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-2">
	    
	    	<a name="comment-487868"></a>
	      	
	      	<div id="li-comment-487868" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 19, 2018 at 12:57 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487868" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487868">
				
				<p>Thanks Atul!</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487868' onclick='return addComment.moveForm( "comment-487868", "487868", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment even thread-odd thread-alt depth-1">
	    
	    	<a name="comment-487847"></a>
	      	
	      	<div id="li-comment-487847" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e0841a34d0a59b0c693020db636924b4?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e0841a34d0a59b0c693020db636924b4?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Faraz</span>           
	                <span class="date">November 19, 2018 at 12:42 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487847" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487847">
				
				<p>Hi Adrain.</p>
<p>                Thank you again for the great effort.My question is that mask rcnn is according to authors of paper Mask rcnn : <a href="https://arxiv.org/pdf/1703.06870.pdf" rel="nofollow">https://arxiv.org/pdf/1703.06870.pdf</a> ,fps is around 5fps.Isnt it a bit slow for using it in real time application and how do you compare YOLO or SSD with it.Thanks.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487847' onclick='return addComment.moveForm( "comment-487847", "487847", "respond", "8999" )' aria-label='Reply to Faraz'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-2">
	    
	    	<a name="comment-487867"></a>
	      	
	      	<div id="li-comment-487867" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 19, 2018 at 12:56 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487867" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487867">
				
				<p>Yes, Faster R-CNN and Mask R-CNN are slower than YOLO and SSD. I would request you read &#8220;Instance segmentation vs. Semantic segmentation&#8221; section of this tutorial &#8212; the section will explain to you how YOLO, SSD, and Faster R-CNN (object detectors) are different than Mask R-CNN (instance segmentation).</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487867' onclick='return addComment.moveForm( "comment-487867", "487867", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment even depth-3">
	    
	    	<a name="comment-487872"></a>
	      	
	      	<div id="li-comment-487872" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e0841a34d0a59b0c693020db636924b4?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e0841a34d0a59b0c693020db636924b4?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Faraz</span>           
	                <span class="date">November 19, 2018 at 1:28 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487872" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487872">
				
				<p>Thanks Adrian ,so what i understand is that mask rcnn may not be suitable for real time applications.Great tutorial by the way.Thumbs up</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487872' onclick='return addComment.moveForm( "comment-487872", "487872", "respond", "8999" )' aria-label='Reply to Faraz'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-even depth-1">
	    
	    	<a name="comment-487881"></a>
	      	
	      	<div id="li-comment-487881" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/dc5542c2ca46e2bc5f11d59b3f5d21ee?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/dc5542c2ca46e2bc5f11d59b3f5d21ee?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Cenk</span>           
	                <span class="date">November 19, 2018 at 2:16 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487881" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487881">
				
				<p>Hi Adrian,</p>
<p>Thank you very much  for your sharing the code along with the blog, as it will be very helpful for us to play around and understand better.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487881' onclick='return addComment.moveForm( "comment-487881", "487881", "respond", "8999" )' aria-label='Reply to Cenk'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor even depth-2">
	    
	    	<a name="comment-487882"></a>
	      	
	      	<div id="li-comment-487882" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 19, 2018 at 2:20 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487882" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487882">
				
				<p>Thanks Cenk!</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487882' onclick='return addComment.moveForm( "comment-487882", "487882", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-odd thread-alt depth-1">
	    
	    	<a name="comment-487892"></a>
	      	
	      	<div id="li-comment-487892" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/989017ba46090b8638d722c9485a8c40?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/989017ba46090b8638d722c9485a8c40?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Walid</span>           
	                <span class="date">November 19, 2018 at 3:36 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487892" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487892">
				
				<p>Thanks a lot.<br />
I worked  when I updated openCV 🙂</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487892' onclick='return addComment.moveForm( "comment-487892", "487892", "respond", "8999" )' aria-label='Reply to Walid'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor even depth-2">
	    
	    	<a name="comment-487899"></a>
	      	
	      	<div id="li-comment-487899" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 19, 2018 at 4:11 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487899" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487899">
				
				<p>Awesome, glad to hear it!</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487899' onclick='return addComment.moveForm( "comment-487899", "487899", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-even depth-1">
	    
	    	<a name="comment-487922"></a>
	      	
	      	<div id="li-comment-487922" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/db824557a5f58d87490548bf0fd37db5?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/db824557a5f58d87490548bf0fd37db5?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">atom</span>           
	                <span class="date">November 19, 2018 at 7:49 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487922" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487922">
				
				<p>Great post, Adrian.  Actually, a large number of papers are published everyday on machine learning, so can you share us the way you keep track almost of them. Thanks so muchs, Adrian</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487922' onclick='return addComment.moveForm( "comment-487922", "487922", "respond", "8999" )' aria-label='Reply to atom'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment even depth-2">
	    
	    	<a name="comment-488214"></a>
	      	
	      	<div id="li-comment-488214" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/db824557a5f58d87490548bf0fd37db5?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/db824557a5f58d87490548bf0fd37db5?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">atom</span>           
	                <span class="date">November 21, 2018 at 4:09 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488214" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488214">
				
				<p>Adrian, please give me some comment about this. Thanks</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488214' onclick='return addComment.moveForm( "comment-488214", "488214", "respond", "8999" )' aria-label='Reply to atom'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-odd thread-alt depth-1">
	    
	    	<a name="comment-487925"></a>
	      	
	      	<div id="li-comment-487925" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d9ad0a3902f07ee2d4a0a5e101b861c8?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d9ad0a3902f07ee2d4a0a5e101b861c8?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name"><a href='http://hftsai.radiagnostics.com' rel='external nofollow' class='url'>Paul</a></span>           
	                <span class="date">November 19, 2018 at 8:17 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487925" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487925">
				
				<p>Hi Adrian<br />
This is awesome. I loved your book. (still trying to learn most of it)<br />
I used matterport&#8217;s Mask RCNN in our software to segment label-free cells in microscopy images and track them.<br />
I wonder if you can comment on two things<br />
1.<br />
would you comment on how to improve the accuracy of the mask?<br />
Do you think it&#8217;s the interpolation error or we can improve the accuracy by increasing the depth of the CNNs?</p>
<p>2. I&#8217;ve seen this &#8220;flicking&#8221; thing in segmentation. (as in video)<br />
If i&#8217;m doing image segmentation, it would be one trained weight can recognize a target, while the other may not. some kind of false negative.<br />
would you know where it came from?</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487925' onclick='return addComment.moveForm( "comment-487925", "487925", "respond", "8999" )' aria-label='Reply to Paul'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor even depth-2">
	    
	    	<a name="comment-488057"></a>
	      	
	      	<div id="li-comment-488057" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 20, 2018 at 9:18 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488057" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488057">
				
				<p>1. Are you already applying data augmentation? If not, make sure you are. I&#8217;m also not sure how much data you have for training but you may need more.</p>
<p>2. False-negatives and false-positives will happen, especially if you&#8217;re trying to run the model on video. Ways to improve your model include using training data that is similar to your testing data, applying data augmentation, regularization, and anything that will increase the ability of your model to generalize.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488057' onclick='return addComment.moveForm( "comment-488057", "488057", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-even depth-1">
	    
	    	<a name="comment-487927"></a>
	      	
	      	<div id="li-comment-487927" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/1541d481c42c39ca8347b99f35f827ce?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1541d481c42c39ca8347b99f35f827ce?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name"><a href='http://jaantalvet.com' rel='external nofollow' class='url'>Jaan</a></span>           
	                <span class="date">November 19, 2018 at 8:24 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487927" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487927">
				
				<p>This is looks really cool. Is this the same thing as pose estimation?</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487927' onclick='return addComment.moveForm( "comment-487927", "487927", "respond", "8999" )' aria-label='Reply to Jaan'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor even depth-2">
	    
	    	<a name="comment-488056"></a>
	      	
	      	<div id="li-comment-488056" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 20, 2018 at 9:16 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488056" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488056">
				
				<p>No, pose estimation actually finds keypoints/landmarks for specific joints/body parts. I&#8217;ll try to cover pose estimation in the future.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488056' onclick='return addComment.moveForm( "comment-488056", "488056", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-odd thread-alt depth-1">
	    
	    	<a name="comment-487955"></a>
	      	
	      	<div id="li-comment-487955" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a75c78f2f571308d5643c97b9518e980?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a75c78f2f571308d5643c97b9518e980?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Sumit</span>           
	                <span class="date">November 20, 2018 at 12:01 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487955" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487955">
				
				<p>Thank you so much for all the wonderful tutorials. i am great follower of your work. had a doubt here:</p>
<p>To perform Localization and Classification at the same time we add 2 fully connected layers at the end of our network architecture. One classifies and other provides the bounding box information. But how will come to know which fully connected layer produces cordinates and which one is for classification?</p>
<p>What i read in some blogs is that we receive a matrix at the end which contains:          [confidence score, bx, by, bw, bh, class1, class2, class3].</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487955' onclick='return addComment.moveForm( "comment-487955", "487955", "respond", "8999" )' aria-label='Reply to Sumit'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor even depth-2">
	    
	    	<a name="comment-488051"></a>
	      	
	      	<div id="li-comment-488051" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 20, 2018 at 9:11 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488051" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488051">
				
				<p>We know due to our implementation. One FC branch is (N + 1)-d where N is the number of class labels plus an additional one for the background. The other FC branch is 4xN-d where each of the four values represents the deltas for the final predicted bounding boxes.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488051' onclick='return addComment.moveForm( "comment-488051", "488051", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-even depth-1">
	    
	    	<a name="comment-487959"></a>
	      	
	      	<div id="li-comment-487959" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e23aed0158176b8caf8ef5bd55e0af33?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e23aed0158176b8caf8ef5bd55e0af33?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Dona Paula</span>           
	                <span class="date">November 20, 2018 at 12:54 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487959" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487959">
				
				<p>Thanks for your invaluable tutorials. I ran your code as is, however I am getting only one object instance segemented. i.e If I have two cars in the image (e.g example1), only one car is detected and instance segmented. I have tried with other images. Same story.</p>
<p>My openCV version is 3.4.3. Please suggest resolution.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487959' onclick='return addComment.moveForm( "comment-487959", "487959", "respond", "8999" )' aria-label='Reply to Dona Paula'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment even depth-2">
	    
	    	<a name="comment-487967"></a>
	      	
	      	<div id="li-comment-487967" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e23aed0158176b8caf8ef5bd55e0af33?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e23aed0158176b8caf8ef5bd55e0af33?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Dona Paula</span>           
	                <span class="date">November 20, 2018 at 1:32 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487967" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487967">
				
				<p>Please ignore my previous comment. I thought it would be an animated gif.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487967' onclick='return addComment.moveForm( "comment-487967", "487967", "respond", "8999" )' aria-label='Reply to Dona Paula'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-3">
	    
	    	<a name="comment-488048"></a>
	      	
	      	<div id="li-comment-488048" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 20, 2018 at 9:08 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488048" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488048">
				
				<p>Click on the window opened by OpenCV and press any key on your keyboard. It will advance the execution of the script to highlight the next car.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488048' onclick='return addComment.moveForm( "comment-488048", "488048", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment even thread-odd thread-alt depth-1">
	    
	    	<a name="comment-487960"></a>
	      	
	      	<div id="li-comment-487960" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c34fa9e167f8ca4de2e046bcc0995fc2?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c34fa9e167f8ca4de2e046bcc0995fc2?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Digant</span>           
	                <span class="date">November 20, 2018 at 1:15 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-487960" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-487960">
				
				<p>Hi Adrian,<br />
 Can you suggest me any architecture for Sementic Segmentation which performs segmentation without resizing the image. Any blog/code related to it would be great.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-487960' onclick='return addComment.moveForm( "comment-487960", "487960", "respond", "8999" )' aria-label='Reply to Digant'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-2">
	    
	    	<a name="comment-488049"></a>
	      	
	      	<div id="li-comment-488049" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 20, 2018 at 9:08 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488049" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488049">
				
				<p>I would suggest starting by reading <a target="blank" href="https://www.pyimagesearch.com/2018/09/03/semantic-segmentation-with-opencv-and-deep-learning/">my tutorial on semantic segmentation</a> to help you get started.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488049' onclick='return addComment.moveForm( "comment-488049", "488049", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment even thread-even depth-1">
	    
	    	<a name="comment-488014"></a>
	      	
	      	<div id="li-comment-488014" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c67841f3ff369e5f238defa8af7d383e?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c67841f3ff369e5f238defa8af7d383e?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Kark</span>           
	                <span class="date">November 20, 2018 at 7:04 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488014" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488014">
				
				<p>Hi Adrian,</p>
<p>Thanks for this awesome post. </p>
<p>I am working on a similar project where I have to identify and localize each object in the picture. Can you please advise how to make this script identify all the objects in the picture like a carton box, wooden block etc. I will not know what could be in the picture in advance.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488014' onclick='return addComment.moveForm( "comment-488014", "488014", "respond", "8999" )' aria-label='Reply to Kark'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-2">
	    
	    	<a name="comment-488041"></a>
	      	
	      	<div id="li-comment-488041" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 20, 2018 at 9:02 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488041" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488041">
				
				<p>You would need to first train a Mask R-CNN to identify each of the objects you would like to recognize. Mask R-CNNs, and in general, all machine learning models, are not magic boxes that intuitively understand the contents of an image. Instead, we need to explicitly train them to do so. If you&#8217;re interested in training your own custom Mask R-CNN networks be sure to refer to <a target="blank" href="https://www.pyimagesearch.com/deep-learning-computer-vision-python-book/">Deep Learning for Computer Vision with Python</a> where I discuss how to train your own models in detail (including code).</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488041' onclick='return addComment.moveForm( "comment-488041", "488041", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment even thread-odd thread-alt depth-1">
	    
	    	<a name="comment-488028"></a>
	      	
	      	<div id="li-comment-488028" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a4e7ab81c95260f045e82d13c8bb9a9b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a4e7ab81c95260f045e82d13c8bb9a9b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">abkul</span>           
	                <span class="date">November 20, 2018 at 7:52 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488028" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488028">
				
				<p>Great tutorial.</p>
<p>I am interested in extracting and classifying/labeling  plant disease(s) and insects from an image sent by a farmer using deep learning paradigm. Please advice the relevant approaches/techniques to be employed.</p>
<p>Are you planning to diversify your blog with examples in the field of plant pests or disease diagnosis in future?</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488028' onclick='return addComment.moveForm( "comment-488028", "488028", "respond", "8999" )' aria-label='Reply to abkul'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-2">
	    
	    	<a name="comment-488037"></a>
	      	
	      	<div id="li-comment-488037" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 20, 2018 at 8:59 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488037" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488037">
				
				<p>I haven&#8217;t covered plant diseases specifically before but I have cover human diseases such as skin lesion/cancer segmentation using a Mask R-CNN. Be sure to take a look at <a target="blank" href="https://www.pyimagesearch.com/deep-learning-computer-vision-python-book/">Deep Learning for Computer Vision with Python</a> for more details. I&#8217;m more than confident that the book would help you complete your plant disease classification project.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488037' onclick='return addComment.moveForm( "comment-488037", "488037", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment even thread-even depth-1">
	    
	    	<a name="comment-488034"></a>
	      	
	      	<div id="li-comment-488034" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/bf9118e505b4b962e52870bf2b8b7f8c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/bf9118e505b4b962e52870bf2b8b7f8c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Abhiraj Biswas</span>           
	                <span class="date">November 20, 2018 at 8:21 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488034" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488034">
				
				<p>As you mentioned it&#8217;s storing as an output I wanted to know How can we show the output on the screen Frame by frame.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488034' onclick='return addComment.moveForm( "comment-488034", "488034", "respond", "8999" )' aria-label='Reply to Abhiraj Biswas'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-2">
	    
	    	<a name="comment-488036"></a>
	      	
	      	<div id="li-comment-488036" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 20, 2018 at 8:57 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488036" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488036">
				
				<p>You can insert a call to <code>cv2.imshow</code> but keep in mind that the Mask R-CNN running on a CPU, at best, may only be able to do 1 FPS. The results wouldn&#8217;t look as good.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488036' onclick='return addComment.moveForm( "comment-488036", "488036", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment even thread-odd thread-alt depth-1">
	    
	    	<a name="comment-488091"></a>
	      	
	      	<div id="li-comment-488091" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d32d2bc4ec42743902105e2cd4e1784b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d32d2bc4ec42743902105e2cd4e1784b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Dave P</span>           
	                <span class="date">November 20, 2018 at 1:02 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488091" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488091">
				
				<p>Hi Adrian,  Another great tutorial &#8211; Your program examples just work first time (unlike many other object detection tutorials on the web&#8230;)<br />
I am trying to reduce the number of false positives from my CCTV alarm system which monitors for visitors against a very &#8216;noisy&#8217; background (trees blowing in the wind etc) and using an RCNN  looks most promising.  The Mask RCNN gives very accurate results but I don&#8217;t really need the pixel-level masks and the extra CPU time to generate them.<br />
Is there a (simple) way to just generate the bounding boxes?<br />
I have tried to use Faster RCNN rather than Mask RCNN but the accuracy I am getting (from the aforementioned web tutorials and Github downloads) is much poorer.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488091' onclick='return addComment.moveForm( "comment-488091", "488091", "respond", "8999" )' aria-label='Reply to Dave P'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-2">
	    
	    	<a name="comment-488276"></a>
	      	
	      	<div id="li-comment-488276" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 21, 2018 at 9:34 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488276" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488276">
				
				<p>If Faster R-CNN isn&#8217;t working you may want to try <a target="blank" href="https://www.pyimagesearch.com/2018/11/12/yolo-object-detection-with-opencv/">YOLO</a> or <a target="blank" href="https://www.pyimagesearch.com/2017/09/18/real-time-object-detection-with-deep-learning-and-opencv/">Single Shot Detector (SSDs).</a></p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488276' onclick='return addComment.moveForm( "comment-488276", "488276", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment even thread-even depth-1">
	    
	    	<a name="comment-488133"></a>
	      	
	      	<div id="li-comment-488133" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/55898a6d199e7734a0738db1e48fa249?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/55898a6d199e7734a0738db1e48fa249?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Paul Z</span>           
	                <span class="date">November 20, 2018 at 5:51 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488133" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488133">
				
				<p>Never even heard of R-CNN until now .. but great follow up to the YOLO post. Question &#8230; sometimes the algo seems to identify the same person twice, very very similar confidence levels and at times, the same person twice, once at ~90% and once at ~50%. </p>
<p>Any ideas?</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488133' onclick='return addComment.moveForm( "comment-488133", "488133", "respond", "8999" )' aria-label='Reply to Paul Z'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-2">
	    
	    	<a name="comment-488270"></a>
	      	
	      	<div id="li-comment-488270" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 21, 2018 at 9:27 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488270" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488270">
				
				<p>The same person in the same frame? Or the same person in subsequent frames?</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488270' onclick='return addComment.moveForm( "comment-488270", "488270", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment even thread-odd thread-alt depth-1">
	    
	    	<a name="comment-488289"></a>
	      	
	      	<div id="li-comment-488289" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2d78e3d8a128ca7ae1ba1ef0e179a58a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2d78e3d8a128ca7ae1ba1ef0e179a58a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">sophia</span>           
	                <span class="date">November 21, 2018 at 10:28 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488289" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488289">
				
				<p>another great article! would it be possible to use instance segmentation or object detection to detect whether an object is on the floor? i wanna be able to scan a room and trigger an alert if an object is on the floor. I haven&#8217;t seen any deep learning algorithm applied to detect the floor. thanks, look forward to your reply.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488289' onclick='return addComment.moveForm( "comment-488289", "488289", "respond", "8999" )' aria-label='Reply to sophia'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-2">
	    
	    	<a name="comment-489045"></a>
	      	
	      	<div id="li-comment-489045" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 25, 2018 at 9:44 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-489045" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-489045">
				
				<p>That would actually be a great application of <a target="blank" href="https://www.pyimagesearch.com/2018/09/03/semantic-segmentation-with-opencv-and-deep-learning/">semantic segmentation.</a> Semantic segmentation algorithms can be used to classify all pixels of an image/frame. Try looking into semantic segmentation algorithms for room understanding.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-489045' onclick='return addComment.moveForm( "comment-489045", "489045", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment even depth-3">
	    
	    	<a name="comment-489063"></a>
	      	
	      	<div id="li-comment-489063" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2d78e3d8a128ca7ae1ba1ef0e179a58a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2d78e3d8a128ca7ae1ba1ef0e179a58a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Sophia</span>           
	                <span class="date">November 25, 2018 at 1:35 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-489063" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-489063">
				
				<p>thanks Adrian, I&#8217;ll look into using semantic segmentation for this, look forward to more articles from you!</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-489063' onclick='return addComment.moveForm( "comment-489063", "489063", "respond", "8999" )' aria-label='Reply to Sophia'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-even depth-1">
	    
	    	<a name="comment-488414"></a>
	      	
	      	<div id="li-comment-488414" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/590bc7eff88bb3d43f885bb20db205f8?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/590bc7eff88bb3d43f885bb20db205f8?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Bharath</span>           
	                <span class="date">November 21, 2018 at 10:56 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488414" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488414">
				
				<p>Hi Adrian, I found u have lots of blogs on install opencv on raspberry pi, they build and compile (min 2hours)&#8230;..I found pip install opencv- python working fine on raspberry Pi. Did you try it?</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488414' onclick='return addComment.moveForm( "comment-488414", "488414", "respond", "8999" )' aria-label='Reply to Bharath'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor even depth-2">
	    
	    	<a name="comment-489032"></a>
	      	
	      	<div id="li-comment-489032" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 25, 2018 at 9:35 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-489032" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-489032">
				
				<p>I actually have an entire tutorial dedicated to <a target="blank" href="https://www.pyimagesearch.com/2018/09/19/pip-install-opencv/">installing OpenCV with pip.</a> I would refer to it to ensure your install is working properly.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-489032' onclick='return addComment.moveForm( "comment-489032", "489032", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-odd thread-alt depth-1">
	    
	    	<a name="comment-488468"></a>
	      	
	      	<div id="li-comment-488468" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a4e7ab81c95260f045e82d13c8bb9a9b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a4e7ab81c95260f045e82d13c8bb9a9b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">abkul</span>           
	                <span class="date">November 22, 2018 at 5:18 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488468" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488468">
				
				<p>Like always great tutorial.</p>
<p>No algorithm is perfect.What are the short comings of Mask R-CNN approach/algorithm?</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488468' onclick='return addComment.moveForm( "comment-488468", "488468", "respond", "8999" )' aria-label='Reply to abkul'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor even depth-2">
	    
	    	<a name="comment-489026"></a>
	      	
	      	<div id="li-comment-489026" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 25, 2018 at 9:29 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-489026" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-489026">
				
				<p>Mask R-CNNs are extremely slow. Even on a GPU they only operate at 5-7 FPS.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-489026' onclick='return addComment.moveForm( "comment-489026", "489026", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-even depth-1">
	    
	    	<a name="comment-488484"></a>
	      	
	      	<div id="li-comment-488484" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/7a448f718e8909f06c5aedb674d1725d?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7a448f718e8909f06c5aedb674d1725d?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Mandar Patil</span>           
	                <span class="date">November 22, 2018 at 6:57 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488484" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488484">
				
				<p>Hey Adrian,<br />
I made the entire tree structure on Google Colab and ran the mask_rcnn.py file. </p>
<p>!python mask_rcnn.py &#8211;mask-rcnn mask-rcnn-coco &#8211;image images/example_01.jpg</p>
<p>It gave the following result:<br />
[INFO] loading Mask R-CNN from disk&#8230;<br />
[INFO] Mask R-CNN took 5.486852 seconds<br />
[INFO] boxes shape: (1, 1, 3, 7)<br />
[INFO] masks shape: (100, 90, 15, 15)<br />
: cannot connect to X server </p>
<p>Could you please tell me why did this happen?</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488484' onclick='return addComment.moveForm( "comment-488484", "488484", "respond", "8999" )' aria-label='Reply to Mandar Patil'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor even depth-2">
	    
	    	<a name="comment-489025"></a>
	      	
	      	<div id="li-comment-489025" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 25, 2018 at 9:28 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-489025" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-489025">
				
				<p>I don&#8217;t believe Google Colab has X11 forwarding which is required to display images via <code>cv2.imshow</code>. Don&#8217;t worry though, you can still <a target="blank" href="https://www.pyimagesearch.com/2014/11/03/display-matplotlib-rgb-image/">use matplotlib to display images.</a></p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-489025' onclick='return addComment.moveForm( "comment-489025", "489025", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-odd thread-alt depth-1">
	    
	    	<a name="comment-488544"></a>
	      	
	      	<div id="li-comment-488544" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/03a77a2c24a8d16c572dc0e6fb1312c5?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/03a77a2c24a8d16c572dc0e6fb1312c5?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">xuli</span>           
	                <span class="date">November 22, 2018 at 11:56 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488544" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488544">
				
				<p>cool..leading the way for us to the most recent technology</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488544' onclick='return addComment.moveForm( "comment-488544", "488544", "respond", "8999" )' aria-label='Reply to xuli'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment even thread-even depth-1">
	    
	    	<a name="comment-488887"></a>
	      	
	      	<div id="li-comment-488887" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/15582d33507a600e4fb17125a40da97a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/15582d33507a600e4fb17125a40da97a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Micha</span>           
	                <span class="date">November 24, 2018 at 3:26 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488887" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488887">
				
				<p>Thinking to use MASK R-CNN for background removal, is there and way to make the mask more accurate then the examples  in the video in the examples?</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488887' onclick='return addComment.moveForm( "comment-488887", "488887", "respond", "8999" )' aria-label='Reply to Micha'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-2">
	    
	    	<a name="comment-488985"></a>
	      	
	      	<div id="li-comment-488985" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 25, 2018 at 8:56 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-488985" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-488985">
				
				<p>You would want to ensure your Mask R-CNN is trained on objects that are similar to the ones in your video streams. A deep learning model is only as good as the training data you give it.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-488985' onclick='return addComment.moveForm( "comment-488985", "488985", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment even depth-3">
	    
	    	<a name="comment-489182"></a>
	      	
	      	<div id="li-comment-489182" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/15582d33507a600e4fb17125a40da97a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/15582d33507a600e4fb17125a40da97a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Micha Amir Cohen</span>           
	                <span class="date">November 26, 2018 at 7:51 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-489182" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-489182">
				
				<p>I&#8217;m talking about person recognize, It can be any person&#8230; so I&#8217;m understanding your comment &#8221; objects that are similar &#8221;</p>
<p>look on the picture below the mask cut part of the person head (the one near the dog)&#8230; for example&#8230;<br />
however if I&#8217;m looking on this document the mask cover the persons better<br />
<a href="https://arxiv.org/pdf/1703.06870.pdf%5D" rel="nofollow">https://arxiv.org/pdf/1703.06870.pdf%5D</a></p>
<p>any idea how the mask can cover the body better then the examples?</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-489182' onclick='return addComment.moveForm( "comment-489182", "489182", "respond", "8999" )' aria-label='Reply to Micha Amir Cohen'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment odd alt depth-4">
	    
	    	<a name="comment-489559"></a>
	      	
	      	<div id="li-comment-489559" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/15582d33507a600e4fb17125a40da97a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/15582d33507a600e4fb17125a40da97a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Micha Amir Cohen</span>           
	                <span class="date">November 28, 2018 at 2:35 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-489559" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-489559">
				
				<p>tFirst thanks for all the information you share with us!!!!</p>
<p>I Just to verify, as I understand your opinion is that better training can improve the mask fit to the object required and it is not the limitation that related to the ability of Mask RCNN and for my needs I need to search for other AI model</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-489559' onclick='return addComment.moveForm( "comment-489559", "489559", "respond", "8999" )' aria-label='Reply to Micha Amir Cohen'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment even thread-odd thread-alt depth-1">
	    
	    	<a name="comment-489137"></a>
	      	
	      	<div id="li-comment-489137" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/f50347bfa10ec60968501dbfbf4c17cb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f50347bfa10ec60968501dbfbf4c17cb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Gagandeep</span>           
	                <span class="date">November 26, 2018 at 3:00 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-489137" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-489137">
				
				<p>Thanx a lot for a great blog !</p>
<p>on internet lots of article available on custom object detection using tensorflow API , but not well explained..</p>
<p>In future Can we except blog on &#8220;Custom object detection using tensorflow API&#8221; ?? </p>
<p>thanx a lot your blogs are really very helpful for us&#8230;</p>
<p>Best regards<br />
Gagandeep</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-489137' onclick='return addComment.moveForm( "comment-489137", "489137", "respond", "8999" )' aria-label='Reply to Gagandeep'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-adrian bypostauthor odd alt depth-2">
	    
	    	<a name="comment-489250"></a>
	      	
	      	<div id="li-comment-489250" class="comment-container">
	      	
					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' /></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Adrian Rosebrock</span>           
	                <span class="date">November 26, 2018 at 2:29 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/11/19/mask-r-cnn-with-opencv/#comment-489250" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry"  id="comment-489250">
				
				<p>Hi Gagandeep &#8212; if you like how I explain computer vision and deep learning here on the PyImageSearch blog I would recommend taking a look at my book, <a target="blank" href="https://www.pyimagesearch.com/deep-learning-computer-vision-python-book/">Deep Learning for Computer Vision with Python</a> which includes six chapters on training your own custom object detectors, including using the TensorFlow Object Detection API.</p>
		            
										
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-489250' onclick='return addComment.moveForm( "comment-489250", "489250", "respond", "8999" )' aria-label='Reply to Adrian Rosebrock'>Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
			</ol>
		 	</div>

	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2018/11/19/mask-r-cnn-with-opencv/#respond" style="display:none;">Click here to cancel reply.</a></small></h3>			<form action="https://www.pyimagesearch.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">
				<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea tabindex="4" id="comment" name="comment" cols="50" rows="10" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><input id="author" name="author" type="text" class="txt" tabindex="1" value="" size="30" aria-required='true' /><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input id="email" name="email" type="text" class="txt" tabindex="2" value="" size="30" aria-required='true' /><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input id="url" name="url" type="text" class="txt" tabindex="3" value="" size="30" /><label for="url">Website</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit Comment" /> <input type='hidden' name='comment_post_ID' value='8999' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="fd6ef718b4" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="220"/></p>			</form>
			</div><!-- #respond -->
	     
            </section><!-- /#main -->
                
            <aside id="sidebar">
<div id="woo_search-2" class="widget widget_woo_search"><div class="search_main">
    <form method="get" class="searchform" action="https://www.pyimagesearch.com/" >
        <input type="text" class="field s" name="s" value="Search..." onfocus="if (this.value == 'Search...') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search...';}" />
                <button type="submit" class="icon-search submit" name="submit" value="Search"></button>
    </form>    
    <div class="fix"></div>
</div>
</div><div id="text-7" class="widget widget_text"><h3>Resource Guide (it&#8217;s totally free).</h3>			<div class="textwidget"><a target="_blank" href="https://app.monstercampaigns.com/c/mdoijtrmex7bpm0rp2hn/" class="manual-optin-trigger" data-optin-slug="mdoijtrmex7bpm0rp2hn"><img title="Get your FREE 17-page Computer Vision and Deep Learning Resource Guide PDF" src="https://www.pyimagesearch.com/wp-content/uploads/2018/08/computer_vision_deep_learning_resource_guide_cover.png" style="padding-right: 10px; width: 105px; float: left;"/></a>
<p>
Get your <strong>FREE 17 page Computer Vision, OpenCV, and Deep Learning Resource Guide PDF.</strong> Inside you'll find my hand-picked tutorials, books, courses, and libraries to help you master CV and DL.
</p>
<div style="clear: left;"></div>
<center><a target="_blank" href="https://app.monstercampaigns.com/c/mdoijtrmex7bpm0rp2hn/" style="color: rgb(255, 255, 255); text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.247059) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.498039) 0px 1px 3px inset, rgba(0, 0, 0, 0.498039) 0px 1px 3px; background: #DF4B4B;">Download for Free!</a></center></div>
		</div><div id="text-9" class="widget widget_text"><h3>Deep Learning for Computer Vision with Python Book — OUT NOW!</h3>			<div class="textwidget"><a target="blank" href="https://www.pyimagesearch.com/deep-learning-computer-vision-python-book/"><img title="Deep Learning with Computer Vision and Python Kickstarter" src="https://www.pyimagesearch.com/static/templates/deep-learning-for-computer-vision/images/dl_for_cv_cover.png" style="padding-bottom: 5px; width: 250px;" onClick="document.location='https://www.pyimagesearch.com/deep-learning-computer-vision-python-book/'; return false;"/></a>
<p>You're interested in deep learning and computer vision, <em>but you don't know how to get started.</em> Let me help. <strong><a target="blank" href="https://www.pyimagesearch.com/deep-learning-computer-vision-python-book/">My new book will teach you all you need to know about deep learning.</a></strong></p>
<p><input type="submit" value="Click here to master deep learning" style="background-color: #DF4B4B;" onClick="document.location='https://www.pyimagesearch.com/deep-learning-computer-vision-python-book/'; return false;" /></p></div>
		</div><div id="text-5" class="widget widget_text"><h3>You can detect faces in images &#038; video.</h3>			<div class="textwidget"><a href="https://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-face-detection" title="Practical Python and OpenCV"><img title="Learn how to detect faces in images and video" src="https://www.pyimagesearch.com/wp-content/uploads/2014/12/adrian_face_detection_sidebar.png" style="padding-bottom: 5px; width: 300px;" onClick="document.location='https://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-face-detection'; return false;"/></a>
<p>
Are you interested in <strong>detecting faces in images & video?</strong> But <strong>tired of Googling for tutorials</strong> that <em>never work?</em> Then let me help! I guarantee that my new book will turn you into a <strong>face detection ninja</strong> by the end of this weekend.
<a href="https://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-face-detection" title="Practical Python and OpenCV" onClick="document.location='https://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-face-detection'; return false;">Click here to give it a shot yourself.</a>
</p>
<p><input type="submit" value="Click here to master face detection" style="background-color: #DF4B4B;" onClick="document.location='https://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-face-detection'; return false;" /></p></div>
		</div><div id="text-8" class="widget widget_text"><h3>PyImageSearch Gurus: NOW ENROLLING!</h3>			<div class="textwidget"><div id="pyimg_gurus_carousel_container" style="width: 300px; height: 310px; cursor: pointer;" onClick="document.location='https://www.pyimagesearch.com/pyimagesearch-gurus/?src=sidebar'; return false;">
	<div id="pyimg_gurus_carousel" style="width: 300px; height: 300px; background: url('https://www.pyimagesearch.com/static/templates/pyimagesearch-gurus/images/gurus_carousel.jpg') no-repeat; background-position: 0px 0px;"></div>
</div>
<p style="margin-bottom: 8px;"><strong>The PyImageSearch Gurus course is <em>now enrolling!</em></strong> Inside the course you'll learn how to perform:</p>
<ul style="margin-bottom: 8px;">
	<li>Automatic License Plate Recognition (ANPR)</li>
	<li>Deep Learning</li>
	<li>Face Recognition</li>
	<li><em>and much more!</em></li>
</ul>
<p><strong>Click the button below to learn more about the course, take a tour, and get 10 (FREE) sample lessons</strong>.</p>
<p><input type="submit" value="Take a tour &amp; get 10 (free) lessons" style="background-color: #DF4B4B;" onClick="document.location='https://www.pyimagesearch.com/pyimagesearch-gurus/?src=sidebar'; return false;"/></p></div>
		</div><div id="woo_blogauthorinfo-2" class="widget widget_woo_blogauthorinfo"><h3>Hello! I&#8217;m Adrian Rosebrock.</h3><span class="left"><img alt='' src='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=90&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=180&#038;d=mm&#038;r=g 2x' class='avatar avatar-90 photo' height='90' width='90' /></span>
<p>I'm an entrepreneur and Ph.D who has launched two successful image search engines, <a target="blank" href="http://www.idmypill.com">ID My Pill</a> and <a target="blank" href="http://www.chicengine.com">Chic Engine</a>. I'm here to share my tips, tricks, and hacks I've learned along the way.</p>
<div class="fix"></div>
</div><div id="text-4" class="widget widget_text"><h3>Learn computer vision in a single weekend.</h3>			<div class="textwidget"><a href="https://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-single-weekend" title="Practical Python and OpenCV"><img title="Become an OpenCV guru" src="https://www.pyimagesearch.com/static/templates/practical-python-and-opencv/images/practical_python_and_opencv_2nd_cover.png" style="margin-left: 35px; padding-bottom: 15px; width: 215px;"/></a>
<p>Want to learn computer vision &amp; OpenCV? I can teach you in a <strong>single weekend</strong>. I know. It sounds crazy, but it’s no joke. My new book is your <strong>guaranteed, quick-start guide</strong> to becoming an OpenCV Ninja. So why not give it a try? <a href="https://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-single-weekend" title="Practical Python and OpenCV">Click here to become a computer vision ninja.</a></p>
<p><input type="submit" value="Click here to become an OpenCV ninja" style="background-color: #DF4B4B;" onClick="document.location='https://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-single-weekend'; return false;" /></p></div>
		</div><div id="text-3" class="widget widget_text"><h3>Subscribe via RSS</h3>			<div class="textwidget"><a target="blank" href="http://feeds.feedburner.com/Pyimagesearch"><img title="PyImageSearch RSS Feed" src="https://www.pyimagesearch.com/wp-content/uploads/2014/01/rss-icon.png"/ style="padding-right: 10px; float: left;"></a>
<p><strong>Never miss a post!</strong> Subscribe to the PyImageSearch RSS Feed and keep up to date with my image search engine tutorials, tips, and tricks</p></div>
		</div>
		<div id="woo_tabs-2" class="widget widget_woo_tabs"> 		<div id="tabs">

            <ul class="wooTabs">
                                <li class="popular"><a href="#tab-pop">Popular</a></li>                                                            </ul>

            <div class="clear"></div>

            <div class="boxes box inside">

	            
                                <ul id="tab-pop" class="list">
                    	<li>
				<a title="Install guide: Raspberry Pi 3 + Raspbian Jessie + OpenCV 3" href="https://www.pyimagesearch.com/2016/04/18/install-guide-raspberry-pi-3-raspbian-jessie-opencv-3/">Install guide: Raspberry Pi 3 + Raspbian Jessie + OpenCV 3</a>
		<span class="meta">April 18, 2016</span>
		<div class="fix"></div>
	</li>
		<li>
				<a title="Raspbian Stretch: Install OpenCV 3 + Python on your Raspberry Pi" href="https://www.pyimagesearch.com/2017/09/04/raspbian-stretch-install-opencv-3-python-on-your-raspberry-pi/">Raspbian Stretch: Install OpenCV 3 + Python on your Raspberry Pi</a>
		<span class="meta">September 4, 2017</span>
		<div class="fix"></div>
	</li>
		<li>
				<a title="Install OpenCV and Python on your Raspberry Pi 2 and B+" href="https://www.pyimagesearch.com/2015/02/23/install-opencv-and-python-on-your-raspberry-pi-2-and-b/">Install OpenCV and Python on your Raspberry Pi 2 and B+</a>
		<span class="meta">February 23, 2015</span>
		<div class="fix"></div>
	</li>
		<li>
				<a title="Home surveillance and motion detection with the Raspberry Pi, Python, OpenCV, and Dropbox" href="https://www.pyimagesearch.com/2015/06/01/home-surveillance-and-motion-detection-with-the-raspberry-pi-python-and-opencv/">Home surveillance and motion detection with the Raspberry Pi, Python, OpenCV, and Dropbox</a>
		<span class="meta">June 1, 2015</span>
		<div class="fix"></div>
	</li>
		<li>
				<a title="Ubuntu 16.04: How to install OpenCV" href="https://www.pyimagesearch.com/2016/10/24/ubuntu-16-04-how-to-install-opencv/">Ubuntu 16.04: How to install OpenCV</a>
		<span class="meta">October 24, 2016</span>
		<div class="fix"></div>
	</li>
		<li>
				<a title="How to install OpenCV 3 on Raspbian Jessie" href="https://www.pyimagesearch.com/2015/10/26/how-to-install-opencv-3-on-raspbian-jessie/">How to install OpenCV 3 on Raspbian Jessie</a>
		<span class="meta">October 26, 2015</span>
		<div class="fix"></div>
	</li>
		<li>
				<a title="Basic motion detection and tracking with Python and OpenCV" href="https://www.pyimagesearch.com/2015/05/25/basic-motion-detection-and-tracking-with-python-and-opencv/">Basic motion detection and tracking with Python and OpenCV</a>
		<span class="meta">May 25, 2015</span>
		<div class="fix"></div>
	</li>
	                </ul>
                                                                
            </div><!-- /.boxes -->

        </div><!-- /wooTabs -->

        </div>         </aside><!-- /#sidebar -->

		</div><!-- /#main-sidebar-container -->         

		
    </div><!-- /#content -->
	
    <!--#footer-widgets-container-->
    <div id="footer-widgets-container">
	</div><!--/#footer_widgets_container_end-->
    <!--#footer_container_start-->
    <div id="footer-container">
	<footer id="footer" class="col-full">

		
		<div id="copyright" class="col-left">
			Find me on <a target="blank" href="https://twitter.com/pyimagesearch" style="font-weight: bold; color: #FFFFFF;">Twitter</a>, <a target="blank" href="https://www.facebook.com/pyimagesearch" style="font-weight: bold; color: #FFFFFF;">Facebook</a>, <a target="blank" href="https://plus.google.com/115909176846554117735/?rel=author" style="font-weight: bold; color: #FFFFFF;">Google+</a>, and <a target="blank" href="http://www.linkedin.com/pub/adrian-rosebrock/2a/873/59b" style="font-weight: bold; color: #FFFFFF;">LinkedIn</a>.<br/>
			<p>&copy; 2018 PyImageSearch. All Rights Reserved. </p>		</div>

		<div id="credit" class="col-right">
		</div>

	</footer>

	    </div><!--/#footer_container_end-->

	</div><!-- /#inner-wrapper -->

</div><!-- /#wrapper -->

<div class="fix"></div><!--/.fix-->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-46641058-1', 'auto', {'allowLinker': true});
  ga('require', 'linker');
  ga('linker:autoLink', ['dpdcart.com']);
  ga('send', 'pageview');

</script>

<! -- Clicky -->
<script src="//static.getclicky.com/js" type="text/javascript"></script>
<script type="text/javascript">try{ clicky.init(101083980); }catch(e){}</script>

<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '4768429';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/4768429.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>

<script type="text/javascript">
  (function() {
    window._pa = window._pa || {};
    // _pa.orderId = "myOrderId"; // OPTIONAL: attach unique conversion identifier to conversions
    // _pa.revenue = "19.99"; // OPTIONAL: attach dynamic purchase values to conversions
    // _pa.productId = "myProductId"; // OPTIONAL: Include product ID for use with dynamic ads
    var pa = document.createElement('script'); pa.type = 'text/javascript'; pa.async = true;
    pa.src = ('https:' == document.location.protocol ? 'https:' : 'http:') + "//tag.perfectaudience.com/serve/54220efd7ab7f03f7e000043.js";
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(pa, s);

// visited blog tracking
window._pq = window._pq || [];
_pq.push(['track', 'visited blog']);
  })();
</script>

<!-- facebook -->
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '1465896023527386');
  fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=1465896023527386&ev=PageView&noscript=1"
/></noscript>
<!-- facebook -->

<! -- scroll to code -->
<script type="text/javascript">
jQuery(document).ready(function(){
	jQuery("#scroll_to_code").click(function(event){
		event.preventDefault();
		jQuery('html, body').animate({scrollTop: jQuery('#post_downloads').offset().top}, 1000);
	});
});
</script>

<!-- gurus sidebar carousel -->
<script type="text/javascript">
	jQuery(document).ready(function(){
		GURUS_CAROUSEL_IDX = 1;

		window.setInterval(function(){
			jQuery("#pyimg_gurus_carousel").fadeOut(function(){
				GURUS_CAROUSEL_TOP = GURUS_CAROUSEL_IDX * -300;
				jQuery("#pyimg_gurus_carousel").css("background-position", "0px " + GURUS_CAROUSEL_TOP + "px");
				GURUS_CAROUSEL_IDX += 1;

				if (GURUS_CAROUSEL_IDX == 4){
					GURUS_CAROUSEL_IDX = 0;
				}
			}).delay(250).fadeIn();
		}, 5000);
	});
</script>
<!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com :: Campaign Title: CS: OpenCV Mask R-CNN --><script type="text/javascript" src="https://a.optmnstr.com/app/js/api.min.js" data-campaign="ryzsxelnx6msppzfoy6p" data-user="18464" data-env="production"></script><!-- / OptinMonster --><!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com :: Campaign Title: CVDL Resource Guide --><script type="text/javascript" src="https://a.optmnstr.com/app/js/api.min.js" data-campaign="mdoijtrmex7bpm0rp2hn" data-user="18464" data-env="production"></script><!-- / OptinMonster -->		<script type="text/javascript">var ryzsxelnx6msppzfoy6p_shortcode = true;var mdoijtrmex7bpm0rp2hn_shortcode = true;</script>
		<script type="text/javascript" src="https://www.pyimagesearch.com/wp-content/cache/minify/69faf.js"></script>

<script type='text/javascript'>
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/www.pyimagesearch.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.pyimagesearch.com/wp-content/cache/minify/0fef6.js"></script>

<script type='text/javascript'>
/* <![CDATA[ */
var pyISjsAfterComment = {"function":"window._dcq = window._dcq || [];\r\nwindow._dcq.push([\"track\", \"Submitted a comment\"]);"};
/* ]]> */
</script>

<script type="text/javascript" src="https://www.pyimagesearch.com/wp-content/cache/minify/9c374.js"></script>

<script type='text/javascript'>
/* <![CDATA[ */
var fsb = {"ajax":"https:\/\/www.pyimagesearch.com\/wp-admin\/admin-ajax.php","nonce":"b9048cec9e"};
/* ]]> */
</script>

<script type="text/javascript" src="https://www.pyimagesearch.com/wp-content/cache/minify/8a711.js"></script>

		<script type="text/javascript">var omapi_localized = { ajax: 'https://www.pyimagesearch.com/wp-admin/admin-ajax.php?optin-monster-ajax-route=1', nonce: '03a271fa49', slugs: {"ryzsxelnx6msppzfoy6p":{"slug":"ryzsxelnx6msppzfoy6p","mailpoet":false},"mdoijtrmex7bpm0rp2hn":{"slug":"mdoijtrmex7bpm0rp2hn","mailpoet":false}} };</script>
		</body>
</html>

<!--
Performance optimized by W3 Total Cache. Learn more: https://www.w3-edge.com/products/

Object Caching 18783/4683 objects using disk
Page Caching using disk: enhanced 
Minified using disk
Database Caching 1/34 queries in 0.172 seconds using disk

Served from: www.pyimagesearch.com @ 2018-12-03 07:31:26 by W3 Total Cache
-->